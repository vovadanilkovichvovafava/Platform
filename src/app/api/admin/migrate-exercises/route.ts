import { NextResponse } from "next/server"
import { getServerSession } from "next-auth"
import { authOptions } from "@/lib/auth"
import { prisma } from "@/lib/prisma"

// One-time migration to add new interactive practice modules
export async function POST() {
  try {
    const session = await getServerSession(authOptions)

    if (!session?.user?.id || session.user.role !== "ADMIN") {
      return NextResponse.json({ error: "–¢–æ–ª—å–∫–æ –∞–¥–º–∏–Ω" }, { status: 403 })
    }

    // Find Vibe Coder trail
    const vibeCoder = await prisma.trail.findUnique({
      where: { slug: "vibe-coder" },
    })

    if (!vibeCoder) {
      return NextResponse.json({ error: "Trail vibe-coder –Ω–µ –Ω–∞–π–¥–µ–Ω" }, { status: 404 })
    }

    // Check if modules already exist
    const existingModule = await prisma.module.findFirst({
      where: { slug: { startsWith: "vibe-roles-practice" } },
    })

    if (existingModule) {
      return NextResponse.json({ message: "–ú–æ–¥—É–ª–∏ —É–∂–µ —Å—É—â–µ—Å—Ç–≤—É—é—Ç", skipped: true })
    }

    // Get current max order
    const maxOrder = await prisma.module.aggregate({
      where: { trailId: vibeCoder.id },
      _max: { order: true },
    })
    let order = (maxOrder._max.order || 0) + 1

    // Create 3 new practice modules
    const newModules = [
      {
        slug: `vibe-roles-practice-${Date.now()}`,
        title: "–†–æ–ª–∏ –≤ Vibe Coding",
        description: "–°–æ–ø–æ—Å—Ç–∞–≤—å—Ç–µ —Ä–æ–ª–∏ AI –∏ —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–∞ —Å –∏—Ö –∑–∞–¥–∞—á–∞–º–∏",
        type: "PRACTICE",
        level: "Beginner",
        points: 60,
        duration: "10 –º–∏–Ω",
        order: order++,
        content: `# –†–æ–ª–∏ –≤ Vibe Coding

–í Vibe Coding –∫–∞–∂–¥—ã–π —É—á–∞—Å—Ç–Ω–∏–∫ –ø—Ä–æ—Ü–µ—Å—Å–∞ –≤—ã–ø–æ–ª–Ω—è–µ—Ç —Å–≤–æ—é —Ä–æ–ª—å. –†–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫ –∏ AI —Ä–∞–±–æ—Ç–∞—é—Ç –≤ –∫–æ–º–∞–Ω–¥–µ, –Ω–æ —É –∫–∞–∂–¥–æ–≥–æ —Å–≤–æ–∏ –∑–∞–¥–∞—á–∏.

## –†–æ–ª—å AI
- –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –∫–æ–¥–∞ –ø–æ –æ–ø–∏—Å–∞–Ω–∏—é
- –†—É—Ç–∏–Ω–Ω—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ (—Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ, —Ä–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥)
- –ü—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–µ —Ä–µ—à–µ–Ω–∏–π –∏ –ø–∞—Ç—Ç–µ—Ä–Ω–æ–≤
- –û—Ç–≤–µ—Ç—ã –Ω–∞ —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –≤–æ–ø—Ä–æ—Å—ã

## –†–æ–ª—å —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–∞
- –§–æ—Ä–º—É–ª–∏—Ä–æ–≤–∫–∞ –∑–∞–¥–∞—á –∏ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏–π
- –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–∞—á–µ—Å—Ç–≤–∞ –∏ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ –∫–æ–¥–∞
- –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω—ã–µ —Ä–µ—à–µ–Ω–∏—è
- –§–∏–Ω–∞–ª—å–Ω–∞—è –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç—å –∑–∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç

## –ó–∞–¥–∞–Ω–∏–µ
–°–æ–µ–¥–∏–Ω–∏—Ç–µ –∫–∞–∂–¥—É—é –∑–∞–¥–∞—á—É —Å –ø—Ä–∞–≤–∏–ª—å–Ω–æ–π —Ä–æ–ª—å—é.`,
        trailId: vibeCoder.id,
        questionType: "MATCHING",
        questionText: "–°–æ–µ–¥–∏–Ω–∏—Ç–µ –∫–∞–∂–¥—É—é –∑–∞–¥–∞—á—É —Å –ø—Ä–∞–≤–∏–ª—å–Ω–æ–π —Ä–æ–ª—å—é",
        questionData: {
          leftItems: [
            { id: "l1", text: "–ì–µ–Ω–µ—Ä–∞—Ü–∏—è –∫–æ–¥–∞ –ø–æ –æ–ø–∏—Å–∞–Ω–∏—é" },
            { id: "l2", text: "–ü—Ä–æ–≤–µ—Ä–∫–∞ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ –∫–æ–¥–∞" },
            { id: "l3", text: "–†—É—Ç–∏–Ω–Ω—ã–π —Ä–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥" },
            { id: "l4", text: "–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω—ã–µ —Ä–µ—à–µ–Ω–∏—è" },
            { id: "l5", text: "–ü—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–µ –ø–∞—Ç—Ç–µ—Ä–Ω–æ–≤" },
            { id: "l6", text: "–§–∏–Ω–∞–ª—å–Ω–∞—è –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç—å" },
          ],
          rightItems: [
            { id: "r1", text: "ü§ñ AI" },
            { id: "r2", text: "üë®‚Äçüíª –†–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫" },
          ],
          correctPairs: {
            l1: "r1",
            l2: "r2",
            l3: "r1",
            l4: "r2",
            l5: "r1",
            l6: "r2",
          },
        },
      },
      {
        slug: `vibe-workflow-practice-${Date.now()}`,
        title: "–ü–æ—Ä—è–¥–æ–∫ —Ä–∞–±–æ—Ç—ã —Å AI",
        description: "–†–∞—Å—Å—Ç–∞–≤—å—Ç–µ —à–∞–≥–∏ —Ä–∞–±–æ—Ç—ã —Å AI –≤ –ø—Ä–∞–≤–∏–ª—å–Ω–æ–º –ø–æ—Ä—è–¥–∫–µ",
        type: "PRACTICE",
        level: "Beginner",
        points: 60,
        duration: "10 –º–∏–Ω",
        order: order++,
        content: `# –ü–æ—Ä—è–¥–æ–∫ —Ä–∞–±–æ—Ç—ã —Å AI

–≠—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–∞—è —Ä–∞–±–æ—Ç–∞ —Å AI —Ç—Ä–µ–±—É–µ—Ç –ø—Ä–∞–≤–∏–ª—å–Ω–æ–π –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ –¥–µ–π—Å—Ç–≤–∏–π. –ï—Å–ª–∏ –ø—Ä–æ–ø—É—Å—Ç–∏—Ç—å —à–∞–≥–∏ –∏–ª–∏ –∏–∑–º–µ–Ω–∏—Ç—å –ø–æ—Ä—è–¥–æ–∫ ‚Äî —Ä–µ–∑—É–ª—å—Ç–∞—Ç –±—É–¥–µ—Ç —Ö—É–∂–µ.

## –ö–ª—é—á–µ–≤—ã–µ —ç—Ç–∞–ø—ã

1. **–ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞** ‚Äî —á—ë—Ç–∫–æ —Å—Ñ–æ—Ä–º—É–ª–∏—Ä—É–π—Ç–µ, —á—Ç–æ –≤–∞–º –Ω—É–∂–Ω–æ
2. **–ö–æ–Ω—Ç–µ–∫—Å—Ç** ‚Äî –ø—Ä–µ–¥–æ—Å—Ç–∞–≤—å—Ç–µ AI –≤—Å—é –Ω–µ–æ–±—Ö–æ–¥–∏–º—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é
3. **–ì–µ–Ω–µ—Ä–∞—Ü–∏—è** ‚Äî –ø–æ–ª—É—á–∏—Ç–µ –∫–æ–¥ –æ—Ç AI
4. **–ü—Ä–æ–≤–µ—Ä–∫–∞** ‚Äî –ø—Ä–æ–∞–Ω–∞–ª–∏–∑–∏—Ä—É–π—Ç–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç –Ω–∞ –æ—à–∏–±–∫–∏
5. **–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ** ‚Äî —É–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –∫–æ–¥ —Ä–∞–±–æ—Ç–∞–µ—Ç
6. **–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è** ‚Äî –¥–æ–±–∞–≤—å—Ç–µ –∫–æ–¥ –≤ –ø—Ä–æ–µ–∫—Ç

## –ó–∞–¥–∞–Ω–∏–µ
–†–∞—Å—Å—Ç–∞–≤—å—Ç–µ —à–∞–≥–∏ –≤ –ø—Ä–∞–≤–∏–ª—å–Ω–æ–º –ø–æ—Ä—è–¥–∫–µ.`,
        trailId: vibeCoder.id,
        questionType: "ORDERING",
        questionText: "–†–∞—Å—Å—Ç–∞–≤—å—Ç–µ —à–∞–≥–∏ —Ä–∞–±–æ—Ç—ã —Å AI –≤ –ø—Ä–∞–≤–∏–ª—å–Ω–æ–º –ø–æ—Ä—è–¥–∫–µ",
        questionData: {
          items: [
            { id: "s1", text: "–°—Ñ–æ—Ä–º—É–ª–∏—Ä–æ–≤–∞—Ç—å —á—ë—Ç–∫—É—é –∑–∞–¥–∞—á—É" },
            { id: "s2", text: "–î–æ–±–∞–≤–∏—Ç—å –∫–æ–Ω—Ç–µ–∫—Å—Ç –∏ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è" },
            { id: "s3", text: "–ü–æ–ª—É—á–∏—Ç—å –∫–æ–¥ –æ—Ç AI" },
            { id: "s4", text: "–ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∫–æ–¥ –Ω–∞ –æ—à–∏–±–∫–∏ –∏ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å" },
            { id: "s5", text: "–ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å —Ä–∞–±–æ—Ç—É –∫–æ–¥–∞" },
            { id: "s6", text: "–ò–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞—Ç—å –≤ –ø—Ä–æ–µ–∫—Ç" },
          ],
          correctOrder: ["s1", "s2", "s3", "s4", "s5", "s6"],
        },
      },
      {
        slug: `vibe-prompt-analysis-${Date.now()}`,
        title: "–ê–Ω–∞–ª–∏–∑ –ø—Ä–æ–º–ø—Ç–æ–≤",
        description: "–ù–∞–π–¥–∏—Ç–µ –æ—à–∏–±–∫–∏ –≤ –ø–ª–æ—Ö–∏—Ö –ø—Ä–æ–º–ø—Ç–∞—Ö",
        type: "PRACTICE",
        level: "Intermediate",
        points: 75,
        duration: "15 –º–∏–Ω",
        order: order++,
        content: `# –ê–Ω–∞–ª–∏–∑ –ø—Ä–æ–º–ø—Ç–æ–≤

–ö–∞—á–µ—Å—Ç–≤–æ –ø—Ä–æ–º–ø—Ç–∞ –Ω–∞–ø—Ä—è–º—É—é –≤–ª–∏—è–µ—Ç –Ω–∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç. –ü–ª–æ—Ö–æ–π –ø—Ä–æ–º–ø—Ç ‚Üí –ø–ª–æ—Ö–æ–π –∫–æ–¥. –ù–∞—É—á–∏—Ç–µ—Å—å –≤–∏–¥–µ—Ç—å –ø—Ä–æ–±–ª–µ–º—ã –≤ –ø—Ä–æ–º–ø—Ç–∞—Ö.

## –ü—Ä–∏–∑–Ω–∞–∫–∏ –ø–ª–æ—Ö–æ–≥–æ –ø—Ä–æ–º–ø—Ç–∞

- –°–ª–∏—à–∫–æ–º –∫–æ—Ä–æ—Ç–∫–∏–π –∏–ª–∏ —Ä–∞—Å–ø–ª—ã–≤—á–∞—Ç—ã–π
- –ù–µ—Ç –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞ (–∫–∞–∫–æ–π –ø—Ä–æ–µ–∫—Ç, –∫–∞–∫–∏–µ —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–∏)
- –ù–µ—Ç –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–π (–±–µ–∑ –±–∏–±–ª–∏–æ—Ç–µ–∫, —Å TypeScript –∏ —Ç.–¥.)
- –ù–µ—Ç —á—ë—Ç–∫–æ–π –∑–∞–¥–∞—á–∏
- –ù–µ—Ç —Ä–æ–ª–∏ –¥–ª—è AI

## –ü—Ä–∏–º–µ—Ä –ø–ª–æ—Ö–æ–≥–æ –ø—Ä–æ–º–ø—Ç–∞

> "—Å–¥–µ–ª–∞–π —Ñ–æ—Ä–º—É"

–ß—Ç–æ –Ω–µ —Ç–∞–∫:
- –ö–∞–∫—É—é —Ñ–æ—Ä–º—É? –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏? –í—Ö–æ–¥–∞? –û–±—Ä–∞—Ç–Ω–æ–π —Å–≤—è–∑–∏?
- –ù–∞ —á—ë–º? React? Vue? Vanilla JS?
- –ö–∞–∫–∏–µ –ø–æ–ª—è? –ö–∞–∫–∞—è –≤–∞–ª–∏–¥–∞—Ü–∏—è?
- –ö—É–¥–∞ –æ—Ç–ø—Ä–∞–≤–ª—è—Ç—å –¥–∞–Ω–Ω—ã–µ?

## –ó–∞–¥–∞–Ω–∏–µ
–ü—Ä–æ–∞–Ω–∞–ª–∏–∑–∏—Ä—É–π—Ç–µ –ø—Ä–æ–º–ø—Ç –∏ –Ω–∞–π–¥–∏—Ç–µ –≤—Å–µ –ø—Ä–æ–±–ª–µ–º—ã.`,
        trailId: vibeCoder.id,
        questionType: "CASE_ANALYSIS",
        questionText: "–ù–∞–π–¥–∏—Ç–µ –≤—Å–µ –ø—Ä–æ–±–ª–µ–º—ã –≤ —ç—Ç–æ–º –ø—Ä–æ–º–ø—Ç–µ",
        questionData: {
          caseContent: "–Ω–∞–ø–∏—à–∏ –º–Ω–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ",
          caseLabel: "–ü—Ä–æ–º–ø—Ç",
          options: [
            {
              id: "o1",
              text: "–ù–µ—Ç –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞ ‚Äî –Ω–µ–ø–æ–Ω—è—Ç–Ω–æ, –∫–∞–∫–æ–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –Ω—É–∂–Ω–æ",
              isCorrect: true,
              explanation: "AI –Ω–µ –∑–Ω–∞–µ—Ç, –Ω—É–∂–Ω–æ –≤–µ–±, –º–æ–±–∏–ª—å–Ω–æ–µ –∏–ª–∏ –¥–µ—Å–∫—Ç–æ–ø –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ",
            },
            {
              id: "o2",
              text: "–ù–µ—Ç —É–∫–∞–∑–∞–Ω–∏—è —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–π ‚Äî –Ω–µ–ø–æ–Ω—è—Ç–Ω–æ, –Ω–∞ —á—ë–º –ø–∏—Å–∞—Ç—å",
              isCorrect: true,
              explanation: "React? Vue? Python? Swift? –ë–µ–∑ —ç—Ç–æ–≥–æ AI –≤—ã–±–µ—Ä–µ—Ç —Å–∞–º",
            },
            {
              id: "o3",
              text: "–ù–µ—Ç —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω—ã—Ö —Ç—Ä–µ–±–æ–≤–∞–Ω–∏–π ‚Äî —á—Ç–æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –¥–æ–ª–∂–Ω–æ –¥–µ–ª–∞—Ç—å?",
              isCorrect: true,
              explanation: "–ö–∞–ª—å–∫—É–ª—è—Ç–æ—Ä? –ß–∞—Ç? –ú–∞–≥–∞–∑–∏–Ω? –ù—É–∂–Ω–æ –æ–ø–∏—Å–∞—Ç—å —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª",
            },
            {
              id: "o4",
              text: "–ù–µ—Ç —Ä–æ–ª–∏ –¥–ª—è AI ‚Äî –æ–Ω –Ω–µ –∑–Ω–∞–µ—Ç, –∫–∞–∫ —Å–µ–±—è –≤–µ—Å—Ç–∏",
              isCorrect: true,
              explanation: "–†–æ–ª—å –ø–æ–º–æ–≥–∞–µ—Ç AI –ø–æ–Ω—è—Ç—å —É—Ä–æ–≤–µ–Ω—å –æ—Ç–≤–µ—Ç–∞ (–¥–∂—É–Ω–∏–æ—Ä vs —Å–µ–Ω—å–æ—Ä)",
            },
            {
              id: "o5",
              text: "–°–ª–∏—à–∫–æ–º –º–Ω–æ–≥–æ –¥–µ—Ç–∞–ª–µ–π –ø–µ—Ä–µ–≥—Ä—É–∂–∞—é—Ç AI",
              isCorrect: false,
              explanation: "–ù–∞–æ–±–æ—Ä–æ—Ç, –≤ —ç—Ç–æ–º –ø—Ä–æ–º–ø—Ç–µ –Ω–µ —Ö–≤–∞—Ç–∞–µ—Ç –¥–µ—Ç–∞–ª–µ–π",
            },
            {
              id: "o6",
              text: "–ü—Ä–æ–º–ø—Ç –Ω–∞–ø–∏—Å–∞–Ω –Ω–∞ —Ä—É—Å—Å–∫–æ–º, –∞ –Ω–∞–¥–æ –Ω–∞ –∞–Ω–≥–ª–∏–π—Å–∫–æ–º",
              isCorrect: false,
              explanation: "–°–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–µ AI –æ—Ç–ª–∏—á–Ω–æ –ø–æ–Ω–∏–º–∞—é—Ç —Ä—É—Å—Å–∫–∏–π —è–∑—ã–∫",
            },
          ],
          minCorrectRequired: 3,
        },
      },
    ]

    const createdModules = []

    for (const mod of newModules) {
      const { questionType, questionText, questionData, ...moduleData } = mod

      // Create module
      const createdModule = await prisma.module.create({
        data: moduleData,
      })

      // Create question for this module
      await prisma.question.create({
        data: {
          moduleId: createdModule.id,
          type: questionType,
          question: questionText,
          options: JSON.stringify([]),
          correctAnswer: 0,
          data: JSON.stringify(questionData),
          order: 1,
        },
      })

      createdModules.push(createdModule.title)
    }

    return NextResponse.json({
      success: true,
      message: "–ú–æ–¥—É–ª–∏ —É—Å–ø–µ—à–Ω–æ –¥–æ–±–∞–≤–ª–µ–Ω—ã",
      modules: createdModules,
    })
  } catch (error) {
    console.error("Migration error:", error)
    return NextResponse.json({ error: "–û—à–∏–±–∫–∞ –º–∏–≥—Ä–∞—Ü–∏–∏" }, { status: 500 })
  }
}

// GET - Check status
export async function GET() {
  try {
    const session = await getServerSession(authOptions)

    if (!session?.user?.id || session.user.role !== "ADMIN") {
      return NextResponse.json({ error: "–¢–æ–ª—å–∫–æ –∞–¥–º–∏–Ω" }, { status: 403 })
    }

    const existingModule = await prisma.module.findFirst({
      where: {
        OR: [
          { slug: { startsWith: "vibe-roles-practice" } },
          { title: "–†–æ–ª–∏ –≤ Vibe Coding" },
        ]
      },
    })

    return NextResponse.json({
      migrated: !!existingModule,
      module: existingModule?.title || null,
    })
  } catch (error) {
    console.error("Check error:", error)
    return NextResponse.json({ error: "–û—à–∏–±–∫–∞ –ø—Ä–æ–≤–µ—Ä–∫–∏" }, { status: 500 })
  }
}

// PATCH - Update existing exercise data (fix emojis, etc.)
export async function PATCH() {
  try {
    const session = await getServerSession(authOptions)

    if (!session?.user?.id || session.user.role !== "ADMIN") {
      return NextResponse.json({ error: "–¢–æ–ª—å–∫–æ –∞–¥–º–∏–Ω" }, { status: 403 })
    }

    // Find the matching exercise module
    const matchingModule = await prisma.module.findFirst({
      where: { title: "–†–æ–ª–∏ –≤ Vibe Coding" },
      include: { questions: true },
    })

    if (matchingModule && matchingModule.questions.length > 0) {
      const updatedMatchingData = {
        leftLabel: "–ó–∞–¥–∞—á–∏",
        rightLabel: "–ò—Å–ø–æ–ª–Ω–∏—Ç–µ–ª—å",
        leftItems: [
          { id: "l1", text: "–ì–µ–Ω–µ—Ä–∞—Ü–∏—è –∫–æ–¥–∞ –ø–æ –æ–ø–∏—Å–∞–Ω–∏—é" },
          { id: "l2", text: "–ü—Ä–æ–≤–µ—Ä–∫–∞ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ –∫–æ–¥–∞" },
          { id: "l3", text: "–†—É—Ç–∏–Ω–Ω—ã–π —Ä–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥" },
          { id: "l4", text: "–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω—ã–µ —Ä–µ—à–µ–Ω–∏—è" },
          { id: "l5", text: "–ü—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–µ –ø–∞—Ç—Ç–µ—Ä–Ω–æ–≤" },
          { id: "l6", text: "–§–∏–Ω–∞–ª—å–Ω–∞—è –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç—å" },
        ],
        rightItems: [
          { id: "r1", text: "AI" },
          { id: "r2", text: "–†–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫" },
        ],
        correctPairs: {
          l1: "r1",
          l2: "r2",
          l3: "r1",
          l4: "r2",
          l5: "r1",
          l6: "r2",
        },
      }

      await prisma.question.update({
        where: { id: matchingModule.questions[0].id },
        data: { data: JSON.stringify(updatedMatchingData) },
      })
    }

    // Find and fix case analysis module
    const caseModule = await prisma.module.findFirst({
      where: { title: "–ê–Ω–∞–ª–∏–∑ –ø—Ä–æ–º–ø—Ç–æ–≤" },
      include: { questions: true },
    })

    if (caseModule && caseModule.questions.length > 0) {
      const updatedCaseData = {
        caseContent: `–ü—Ä–∏–≤–µ—Ç! –ú–Ω–µ –Ω—É–∂–Ω–æ —Å–¥–µ–ª–∞—Ç—å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ —Ç–∏–ø–∞ Uber, —Ç–æ–ª—å–∫–æ –¥–ª—è –¥–æ—Å—Ç–∞–≤–∫–∏ –µ–¥—ã. –°–¥–µ–ª–∞–π –∫—Ä–∞—Å–∏–≤—ã–π —Å–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–π –¥–∏–∑–∞–π–Ω. –ù—É–∂–Ω–æ —á—Ç–æ–±—ã —Ä–∞–±–æ—Ç–∞–ª–æ –±—ã—Å—Ç—Ä–æ –∏ –±–µ–∑ –±–∞–≥–æ–≤. –ò—Å–ø–æ–ª—å–∑—É–π –ª—É—á—à–∏–µ –ø—Ä–∞–∫—Ç–∏–∫–∏. –ë—é–¥–∂–µ—Ç –Ω–µ–±–æ–ª—å—à–æ–π, –ø–æ—ç—Ç–æ–º—É —Å–¥–µ–ª–∞–π –ø–æ–ø—Ä–æ—â–µ.`,
        caseLabel: "–ü—Ä–æ–º–ø—Ç –æ—Ç –∑–∞–∫–∞–∑—á–∏–∫–∞",
        options: [
          {
            id: "o1",
            text: "¬´–¢–∏–ø–∞ Uber¬ª ‚Äî —Å–ª–∏—à–∫–æ–º —Ä–∞–∑–º—ã—Ç–∞—è –∞–Ω–∞–ª–æ–≥–∏—è",
            isCorrect: true,
            explanation: "Uber –∏–º–µ–µ—Ç —Å–æ—Ç–Ω–∏ —Ñ—É–Ω–∫—Ü–∏–π. –ö–∞–∫–∏–µ –∏–º–µ–Ω–Ω–æ –Ω—É–∂–Ω—ã? –ö–∞—Ä—Ç–∞? –†–µ–π—Ç–∏–Ω–≥–∏? –ß–∞—Ç? –û–ø–ª–∞—Ç–∞?",
          },
          {
            id: "o2",
            text: "¬´–ö—Ä–∞—Å–∏–≤—ã–π –¥–∏–∑–∞–π–Ω¬ª ‚Äî —Å—É–±—ä–µ–∫—Ç–∏–≤–Ω–æ–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏–µ",
            isCorrect: true,
            explanation: "–ß—Ç–æ —Ç–∞–∫–æ–µ ¬´–∫—Ä–∞—Å–∏–≤–æ¬ª? –ù—É–∂–Ω—ã –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–µ —Ä–µ—Ñ–µ—Ä–µ–Ω—Å—ã, —Ü–≤–µ—Ç–∞, —Å—Ç–∏–ª—å",
          },
          {
            id: "o3",
            text: "–ù–µ —É–∫–∞–∑–∞–Ω–∞ –ø–ª–∞—Ç—Ñ–æ—Ä–º–∞ ‚Äî –≤–µ–±, iOS –∏–ª–∏ Android?",
            isCorrect: true,
            explanation: "–†–∞–∑–Ω—ã–µ –ø–ª–∞—Ç—Ñ–æ—Ä–º—ã = —Ä–∞–∑–Ω—ã–µ —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–∏ –∏ –ø–æ–¥—Ö–æ–¥—ã. –≠—Ç–æ –∫—Ä–∏—Ç–∏—á–Ω–æ",
          },
          {
            id: "o4",
            text: "–ù–µ—Ç –æ–ø–∏—Å–∞–Ω–∏—è —Ä–æ–ª–µ–π ‚Äî –∫—Ç–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ —Å–∏—Å—Ç–µ–º—ã?",
            isCorrect: true,
            explanation: "–ö–ª–∏–µ–Ω—Ç? –ö—É—Ä—å–µ—Ä? –†–µ—Å—Ç–æ—Ä–∞–Ω? –ê–¥–º–∏–Ω? –£ –∫–∞–∂–¥–æ–≥–æ —Å–≤–æ–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å",
          },
          {
            id: "o5",
            text: "¬´–õ—É—á—à–∏–µ –ø—Ä–∞–∫—Ç–∏–∫–∏¬ª ‚Äî –Ω–µ–ø–æ–Ω—è—Ç–Ω–æ –∫–∞–∫–∏–µ –∏–º–µ–Ω–Ω–æ",
            isCorrect: true,
            explanation: "–õ—É—á—à–∏–µ –ø—Ä–∞–∫—Ç–∏–∫–∏ —á–µ–≥–æ? –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏? UX? –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏? –ù—É–∂–Ω–∞ –∫–æ–Ω–∫—Ä–µ—Ç–∏–∫–∞",
          },
          {
            id: "o6",
            text: "–ü—Ä–æ–º–ø—Ç —Å–ª–∏—à–∫–æ–º –¥–ª–∏–Ω–Ω—ã–π –¥–ª—è AI",
            isCorrect: false,
            explanation: "–î–ª–∏–Ω–∞ –ø—Ä–æ–º–ø—Ç–∞ –Ω–µ –ø—Ä–æ–±–ª–µ–º–∞. AI —Å–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è —Å –±–æ–ª—å—à–∏–º–∏ —Ç–µ–∫—Å—Ç–∞–º–∏",
          },
          {
            id: "o7",
            text: "–ù–µ–ª—å–∑—è —É–ø–æ–º–∏–Ω–∞—Ç—å –±—é–¥–∂–µ—Ç –≤ –ø—Ä–æ–º–ø—Ç–µ",
            isCorrect: false,
            explanation: "–ë—é–¥–∂–µ—Ç –º–æ–∂–Ω–æ —É–ø–æ–º–∏–Ω–∞—Ç—å, –Ω–æ —ç—Ç–æ –Ω–µ –∑–∞–º–µ–Ω—è–µ—Ç —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∏—Ö —Ç—Ä–µ–±–æ–≤–∞–Ω–∏–π",
          },
        ],
        minCorrectRequired: 4,
      }

      await prisma.question.update({
        where: { id: caseModule.questions[0].id },
        data: { data: JSON.stringify(updatedCaseData) },
      })
    }

    return NextResponse.json({
      success: true,
      message: "–î–∞–Ω–Ω—ã–µ –æ–±–Ω–æ–≤–ª–µ–Ω—ã",
    })
  } catch (error) {
    console.error("Update error:", error)
    return NextResponse.json({ error: "–û—à–∏–±–∫–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è" }, { status: 500 })
  }
}

// PUT - Update module content with rich educational material
export async function PUT() {
  try {
    const session = await getServerSession(authOptions)

    if (!session?.user?.id || session.user.role !== "ADMIN") {
      return NextResponse.json({ error: "–¢–æ–ª—å–∫–æ –∞–¥–º–∏–Ω" }, { status: 403 })
    }

    // =============================================
    // –ú–û–î–£–õ–¨ 1: –†–æ–ª–∏ –≤ Vibe Coding
    // =============================================
    const rolesContent = `# –†–æ–ª–∏ –≤ Vibe Coding

## –ì–ª–∞–≤–Ω–∞—è –∏–¥–µ—è

Vibe Coding ‚Äî —ç—Ç–æ **–ø–∞—Ä—Ç–Ω—ë—Ä—Å—Ç–≤–æ** –º–µ–∂–¥—É –≤–∞–º–∏ –∏ AI. –í—ã ‚Äî –∞—Ä—Ö–∏—Ç–µ–∫—Ç–æ—Ä –∏ –∫–æ–Ω—Ç—Ä–æ–ª—ë—Ä. AI ‚Äî –±—ã—Å—Ç—Ä—ã–π –∏—Å–ø–æ–ª–Ω–∏—Ç–µ–ª—å. –£—Å–ø–µ—Ö –∑–∞–≤–∏—Å–∏—Ç –æ—Ç —Ç–æ–≥–æ, –Ω–∞—Å–∫–æ–ª—å–∫–æ —á—ë—Ç–∫–æ –≤—ã —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–∏—Ç–µ –∑–∞–¥–∞—á–∏.

> **–ó–∞–ø–æ–º–Ω–∏—Ç–µ:** AI –Ω–µ –∑–∞–º–µ–Ω—è–µ—Ç —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–∞. AI —É—Å–∏–ª–∏–≤–∞–µ—Ç —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–∞.

---

## –ß—Ç–æ –¥–µ–ª–∞–µ—Ç AI

AI –æ—Ç–ª–∏—á–Ω–æ —Å–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è —Å –∑–∞–¥–∞—á–∞–º–∏, –∫–æ—Ç–æ—Ä—ã–µ –º–æ–∂–Ω–æ **—á—ë—Ç–∫–æ –æ–ø–∏—Å–∞—Ç—å**.

### –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –∫–æ–¥–∞

–í—ã –æ–ø–∏—Å—ã–≤–∞–µ—Ç–µ ‚Äî AI –ø–∏—à–µ—Ç:

\`\`\`
–ü—Ä–æ–º–ø—Ç: "–§—É–Ω–∫—Ü–∏—è –≤–∞–ª–∏–¥–∞—Ü–∏–∏ email –Ω–∞ TypeScript"

–†–µ–∑—É–ª—å—Ç–∞—Ç: –≥–æ—Ç–æ–≤–∞—è —Ñ—É–Ω–∫—Ü–∏—è —Å regex, —Ç–∏–ø–∞–º–∏, –æ–±—Ä–∞–±–æ—Ç–∫–æ–π –æ—à–∏–±–æ–∫
\`\`\`

### –†–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥

AI –±—ã—Å—Ç—Ä–æ –≤—ã–ø–æ–ª–Ω—è–µ—Ç —Ä—É—Ç–∏–Ω–Ω—ã–µ –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏—è:
- –ü–µ—Ä–µ–∏–º–µ–Ω–æ–≤–∞–Ω–∏–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö
- –ö–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏—è callback ‚Üí async/await
- –†–∞–∑–±–∏–µ–Ω–∏–µ –±–æ–ª—å—à–∏—Ö —Ñ—É–Ω–∫—Ü–∏–π
- –î–æ–±–∞–≤–ª–µ–Ω–∏–µ TypeScript —Ç–∏–ø–æ–≤

### –ì–µ–Ω–µ—Ä–∞—Ü–∏—è —à–∞–±–ª–æ–Ω–æ–≤

–í—Å—ë, —á—Ç–æ –ø–æ–≤—Ç–æ—Ä—è–µ—Ç—Å—è ‚Äî –æ—Ç–¥–∞–π—Ç–µ AI:
- –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ø—Ä–æ–µ–∫—Ç–∞ (–∫–æ–Ω—Ñ–∏–≥–∏, –ª–∏–Ω—Ç–µ—Ä—ã)
- CRUD –æ–ø–µ—Ä–∞—Ü–∏–∏
- –ë–∞–∑–æ–≤—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã
- Unit —Ç–µ—Å—Ç—ã

### –û–±—ä—è—Å–Ω–µ–Ω–∏–µ –∏ –ø–æ–∏—Å–∫ —Ä–µ—à–µ–Ω–∏–π

AI –∑–Ω–∞–µ—Ç –º–∏–ª–ª–∏–æ–Ω—ã –ø–∞—Ç—Ç–µ—Ä–Ω–æ–≤:

\`\`\`
–í–æ–ø—Ä–æ—Å: "–ö–∞–∫ –ª—É—á—à–µ —É–ø—Ä–∞–≤–ª—è—Ç—å —Å–æ—Å—Ç–æ—è–Ω–∏–µ–º —Ñ–æ—Ä–º—ã –≤ React?"

–û—Ç–≤–µ—Ç: —Å—Ä–∞–≤–Ω–µ–Ω–∏–µ useState, useReducer, React Hook Form
—Å –ø–ª—é—Å–∞–º–∏, –º–∏–Ω—É—Å–∞–º–∏ –∏ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è–º–∏
\`\`\`

---

## –ß—Ç–æ –¥–µ–ª–∞–µ—Ç —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫

–†–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫ –æ—Ç–≤–µ—á–∞–µ—Ç –∑–∞ –≤—Å—ë, —á—Ç–æ —Ç—Ä–µ–±—É–µ—Ç **–ø–æ–Ω–∏–º–∞–Ω–∏—è –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞** –∏ **–ø—Ä–∏–Ω—è—Ç–∏—è —Ä–µ—à–µ–Ω–∏–π**.

### –ü–æ—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–¥–∞—á

**–ü–ª–æ—Ö–æ:**
\`\`\`
"—Å–¥–µ–ª–∞–π —Ñ–æ—Ä–º—É"
\`\`\`

**–•–æ—Ä–æ—à–æ:**
\`\`\`
"–§–æ—Ä–º–∞ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ –Ω–∞ React:
- –ü–æ–ª—è: email, –ø–∞—Ä–æ–ª—å, –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ
- –í–∞–ª–∏–¥–∞—Ü–∏—è: email —Ñ–æ—Ä–º–∞—Ç, –ø–∞—Ä–æ–ª—å 8+ —Å–∏–º–≤–æ–ª–æ–≤
- –°—Ç–µ–∫: React Hook Form + Zod + Tailwind"
\`\`\`

–ß–µ–º —Ç–æ—á–Ω–µ–µ –∑–∞–¥–∞—á–∞ ‚Äî —Ç–µ–º –ª—É—á—à–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç.

### –ü—Ä–æ–≤–µ—Ä–∫–∞ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏

AI –º–æ–∂–µ—Ç –ø—Ä–µ–¥–ª–æ–∂–∏—Ç—å –Ω–µ–±–µ–∑–æ–ø–∞—Å–Ω—ã–π –∫–æ–¥. –í–∞—à–∞ –∑–∞–¥–∞—á–∞ ‚Äî –∑–∞–º–µ—Ç–∏—Ç—å:

| –ü—Ä–æ–±–ª–µ–º–∞ | –ß—Ç–æ –∏—Å–∫–∞—Ç—å –≤ –∫–æ–¥–µ |
|----------|-------------------|
| SQL injection | –ö–æ–Ω–∫–∞—Ç–µ–Ω–∞—Ü–∏—è –≤ –∑–∞–ø—Ä–æ—Å–∞—Ö |
| XSS | innerHTML –±–µ–∑ —Å–∞–Ω–∏—Ç–∏–∑–∞—Ü–∏–∏ |
| –£—Ç–µ—á–∫–∞ –¥–∞–Ω–Ω—ã—Ö | –ü–∞—Ä–æ–ª–∏ –≤ plain text |
| –£—è–∑–≤–∏–º—ã–π CORS | Wildcard (*) –≤ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞—Ö |

### –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω—ã–µ —Ä–µ—à–µ–Ω–∏—è

AI –ø—Ä–µ–¥–ª–∞–≥–∞–µ—Ç –≤–∞—Ä–∏–∞–Ω—Ç—ã. –í—ã –≤—ã–±–∏—Ä–∞–µ—Ç–µ:
- –ö–∞–∫–∏–µ —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å
- –ö–∞–∫ —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞—Ç—å –∫–æ–¥
- –ö–∞–∫–∏–µ –ø–∞—Ç—Ç–µ—Ä–Ω—ã –ø—Ä–∏–º–µ–Ω–∏—Ç—å
- –ö–∞–∫ –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞—Ç—å —Å–∏—Å—Ç–µ–º—É

### –§–∏–Ω–∞–ª—å–Ω–∞—è –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç—å

> **–í–∞–∂–Ω–æ:** –ö–æ–¥ –≤ production ‚Äî –≤–∞—à–∞ –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç—å.
> –ï—Å–ª–∏ AI –Ω–∞–ø–∏—Å–∞–ª –±–∞–≥ ‚Äî –æ—Ç–≤–µ—á–∞–µ—Ç–µ –≤—ã.

---

## –ü—Ä–∏–º–µ—Ä: –¥–æ–±–∞–≤–ª—è–µ–º –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—é

**–†–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫ —Ä–µ—à–∞–µ—Ç:**
1. –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å JWT + httpOnly cookies
2. –ë–∏–±–ª–∏–æ—Ç–µ–∫–∞: jose
3. Flow: login ‚Üí access token ‚Üí refresh token

**AI –≤—ã–ø–æ–ª–Ω—è–µ—Ç:**
1. "–ù–∞–ø–∏—à–∏ middleware –ø—Ä–æ–≤–µ—Ä–∫–∏ JWT –≤ Next.js"
2. "–°–æ–∑–¥–∞–π API route –¥–ª—è login"
3. "–î–æ–±–∞–≤—å –ª–æ–≥–∏–∫—É refresh token"

**–†–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫ –ø—Ä–æ–≤–µ—Ä—è–µ—Ç:**
- –¢–æ–∫–µ–Ω—ã –Ω–µ –≤ localStorage (–∑–∞—â–∏—Ç–∞ –æ—Ç XSS)
- –ü–∞—Ä–æ–ª–∏ —Ö–µ—à–∏—Ä—É—é—Ç—Å—è —á–µ—Ä–µ–∑ bcrypt
- –ï—Å—Ç—å rate limiting –Ω–∞ login
- –ü—Ä–∞–≤–∏–ª—å–Ω—ã–µ HTTP —Å—Ç–∞—Ç—É—Å—ã (401, 403)

---

## –ö–ª—é—á–µ–≤—ã–µ –≤—ã–≤–æ–¥—ã

1. **AI = –∏—Å–ø–æ–ª–Ω–∏—Ç–µ–ª—å.** –î–µ–ª–µ–≥–∏—Ä—É–π—Ç–µ —Ä—É—Ç–∏–Ω—É.
2. **–í—ã = –∞—Ä—Ö–∏—Ç–µ–∫—Ç–æ—Ä.** –ü—Ä–∏–Ω–∏–º–∞–π—Ç–µ —Ä–µ—à–µ–Ω–∏—è.
3. **–ü—Ä–æ–≤–µ—Ä—è–π—Ç–µ –≤—Å—ë.** –û—Å–æ–±–µ–Ω–Ω–æ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å.
4. **–û—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç—å –Ω–∞ –≤–∞—Å.** –í—Å–µ–≥–¥–∞.

---

## –ó–∞–¥–∞–Ω–∏–µ

–ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø–æ–Ω–∏–º–∞–Ω–∏–µ: —Å–æ–µ–¥–∏–Ω–∏—Ç–µ –∫–∞–∂–¥—É—é –∑–∞–¥–∞—á—É —Å —Ç–µ–º, –∫—Ç–æ –¥–æ–ª–∂–µ–Ω –µ—ë –≤—ã–ø–æ–ª–Ω—è—Ç—å.`

    // =============================================
    // –ú–û–î–£–õ–¨ 2: –ü–æ—Ä—è–¥–æ–∫ —Ä–∞–±–æ—Ç—ã —Å AI
    // =============================================
    const workflowContent = `# –ü–æ—Ä—è–¥–æ–∫ —Ä–∞–±–æ—Ç—ã —Å AI

## –ó–∞—á–µ–º –Ω—É–∂–µ–Ω –ø—Ä–æ—Ü–µ—Å—Å

–¢–∏–ø–∏—á–Ω–∞—è –æ—à–∏–±–∫–∞ –Ω–æ–≤–∏—á–∫–∞:

\`\`\`
–°–ø—Ä–æ—Å–∏–ª ‚Üí –ü–æ–ª—É—á–∏–ª –∫–æ–¥ ‚Üí –í—Å—Ç–∞–≤–∏–ª ‚Üí –ù–µ —Ä–∞–±–æ—Ç–∞–µ—Ç ‚Üí –°–ø—Ä–æ—Å–∏–ª —Å–Ω–æ–≤–∞ ‚Üí ...
\`\`\`

–≠—Ç–æ **–Ω–µ—ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ**. –ü—Ä–∞–≤–∏–ª—å–Ω—ã–π –ø—Ä–æ—Ü–µ—Å—Å —ç–∫–æ–Ω–æ–º–∏—Ç —á–∞—Å—ã —Ä–∞–±–æ—Ç—ã.

---

## –®–∞–≥ 1. –°—Ñ–æ—Ä–º—É–ª–∏—Ä—É–π—Ç–µ –∑–∞–¥–∞—á—É

–ü—Ä–µ–∂–¥–µ —á–µ–º –ø–∏—Å–∞—Ç—å –ø—Ä–æ–º–ø—Ç ‚Äî –æ—Ç–≤–µ—Ç—å—Ç–µ —Å–µ–±–µ:

- –ß—Ç–æ –¥–æ–ª–∂–Ω–æ –ø–æ–ª—É—á–∏—Ç—å—Å—è?
- –ö–∞–∫–∏–µ –≤—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ?
- –ö–∞–∫–æ–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç –Ω–∞ –≤—ã—Ö–æ–¥–µ?
- –ö–∞–∫–∏–µ –∫—Ä–∞–π–Ω–∏–µ —Å–ª—É—á–∞–∏?

### –ü—Ä–∏–º–µ—Ä

**–ü–ª–æ—Ö–æ:**
\`\`\`
"–°–¥–µ–ª–∞–π –ø–æ–∏—Å–∫"
\`\`\`

**–•–æ—Ä–æ—à–æ:**
\`\`\`
–§—É–Ω–∫—Ü–∏—è –ø–æ–∏—Å–∫–∞ —Ç–æ–≤–∞—Ä–æ–≤:
‚Ä¢ Input: —Å—Ç—Ä–æ–∫–∞ –∑–∞–ø—Ä–æ—Å–∞ + –º–∞—Å—Å–∏–≤ —Ç–æ–≤–∞—Ä–æ–≤
‚Ä¢ Output: –æ—Ç—Ñ–∏–ª—å—Ç—Ä–æ–≤–∞–Ω–Ω—ã–π –º–∞—Å—Å–∏–≤
‚Ä¢ –ü–æ–∏—Å–∫ –ø–æ: name, description, tags
‚Ä¢ –†–µ–≥–∏—Å—Ç—Ä: –Ω–µ –≤–∞–∂–µ–Ω
‚Ä¢ –°–æ–≤–ø–∞–¥–µ–Ω–∏–µ: —á–∞—Å—Ç–∏—á–Ω–æ–µ
\`\`\`

### –õ–∞–π—Ñ—Ö–∞–∫

–ó–∞–ø–∏—à–∏—Ç–µ –∑–∞–¥–∞—á—É –≤ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏ –ø–µ—Ä–µ–¥ –ø—Ä–æ–º–ø—Ç–æ–º:

\`\`\`javascript
// –ó–ê–î–ê–ß–ê: –í–∞–ª–∏–¥–∞—Ü–∏—è —Ñ–æ—Ä–º—ã
// INPUT: { email, password, confirmPassword }
// OUTPUT: { valid: boolean, errors: string[] }
// –ü–†–ê–í–ò–õ–ê:
//   - email: —Ñ–æ—Ä–º–∞—Ç xxx@xxx.xx
//   - password: 8+ —Å–∏–º–≤–æ–ª–æ–≤, —Ü–∏—Ñ—Ä–∞, —Å–ø–µ—Ü—Å–∏–º–≤–æ–ª
//   - passwords –¥–æ–ª–∂–Ω—ã —Å–æ–≤–ø–∞–¥–∞—Ç—å
\`\`\`

–¢–µ–ø–µ—Ä—å –ø—Ä–æ–º–ø—Ç –Ω–∞–ø–∏—à–µ—Ç—Å—è —Å–∞–º.

---

## –®–∞–≥ 2. –î–æ–±–∞–≤—å—Ç–µ –∫–æ–Ω—Ç–µ–∫—Å—Ç

AI –Ω–µ –∑–Ω–∞–µ—Ç –≤–∞—à –ø—Ä–æ–µ–∫—Ç. –û–±—ä—è—Å–Ω–∏—Ç–µ:

- –ö–∞–∫–∏–µ —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–∏
- –ö–∞–∫–æ–π —Å—Ç–∏–ª—å –∫–æ–¥–∞
- –ö–∞–∫–∏–µ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è

### –ë–µ–∑ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞

\`\`\`
"–ù–∞–ø–∏—à–∏ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç –∫–∞—Ä—Ç–æ—á–∫–∏ —Ç–æ–≤–∞—Ä–∞"
\`\`\`

AI –º–æ–∂–µ—Ç –≤—ã–¥–∞—Ç—å:
- Class component (–∞ —É –≤–∞—Å —Ñ—É–Ω–∫—Ü–∏–∏)
- Styled-components (–∞ —É –≤–∞—Å Tailwind)
- JavaScript (–∞ —É –≤–∞—Å TypeScript)

### –° –∫–æ–Ω—Ç–µ–∫—Å—Ç–æ–º

\`\`\`
–ö–æ–º–ø–æ–Ω–µ–Ω—Ç –∫–∞—Ä—Ç–æ—á–∫–∏ —Ç–æ–≤–∞—Ä–∞.

–°—Ç–µ–∫: Next.js 14, TypeScript, Tailwind CSS

–¢—Ä–µ–±–æ–≤–∞–Ω–∏—è:
‚Ä¢ –§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–π –∫–æ–º–ø–æ–Ω–µ–Ω—Ç
‚Ä¢ Props: { id, name, price, image }
‚Ä¢ –ê–¥–∞–ø—Ç–∏–≤–Ω—ã–π –¥–∏–∑–∞–π–Ω
‚Ä¢ –°—Å—ã–ª–∫–∞ –Ω–∞ /products/[id]
\`\`\`

### –°–æ–∑–¥–∞–π—Ç–µ —Ñ–∞–π–ª –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞

–°–æ—Ö—Ä–∞–Ω–∏—Ç–µ –≤ –ø—Ä–æ–µ–∫—Ç–µ **CONTEXT.md**:

\`\`\`markdown
# –ö–æ–Ω—Ç–µ–∫—Å—Ç –¥–ª—è AI

## –°—Ç–µ–∫
- Next.js 14 (App Router)
- TypeScript strict
- Tailwind CSS
- Prisma + PostgreSQL

## –ö–æ–Ω–≤–µ–Ω—Ü–∏–∏
- –§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã
- Named exports
- camelCase –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ
- PascalCase –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã
\`\`\`

–ö–æ–ø–∏—Ä—É–π—Ç–µ –≤ –ø—Ä–æ–º–ø—Ç –ø—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏.

---

## –®–∞–≥ 3. –ü–æ–ª—É—á–∏—Ç–µ –∫–æ–¥

### –ü—Ä–∏–Ω—Ü–∏–ø: –æ–¥–Ω–∞ –∑–∞–¥–∞—á–∞ ‚Äî –æ–¥–∏–Ω –∑–∞–ø—Ä–æ—Å

**–ü–ª–æ—Ö–æ:**
\`\`\`
"–°–¥–µ–ª–∞–π –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—é, —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—é,
–≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –ø–∞—Ä–æ–ª—è –∏ –ø—Ä–æ—Ñ–∏–ª—å"
\`\`\`

**–•–æ—Ä–æ—à–æ:**
1. "–°–¥–µ–ª–∞–π —Ñ–æ—Ä–º—É —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏"
2. "–î–æ–±–∞–≤—å API –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è"
3. "–°–¥–µ–ª–∞–π —Ñ–æ—Ä–º—É –≤—Ö–æ–¥–∞"
4. ...

### –ò—Ç–µ—Ä–∞—Ç–∏–≤–Ω–æ–µ —É–ª—É—á—à–µ–Ω–∏–µ

–ü–æ–ª—É—á–∏–ª–∏ –∫–æ–¥ ‚Üí –ø—Ä–æ—Å–∏—Ç–µ —É–ª—É—á—à–∏—Ç—å:

\`\`\`
"–î–æ–±–∞–≤—å –æ–±—Ä–∞–±–æ—Ç–∫—É –æ—à–∏–±–æ–∫ —Å–µ—Ç–∏"
"–í—ã–Ω–µ—Å–∏ –≤–∞–ª–∏–¥–∞—Ü–∏—é –≤ –æ—Ç–¥–µ–ª—å–Ω—É—é —Ñ—É–Ω–∫—Ü–∏—é"
"–î–æ–±–∞–≤—å TypeScript —Ç–∏–ø—ã"
\`\`\`

---

## –®–∞–≥ 4. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –∫–æ–¥

### –ß–µ–∫-–ª–∏—Å—Ç

**–§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å:**
- [ ] –î–µ–ª–∞–µ—Ç —Ç–æ, —á—Ç–æ –Ω—É–∂–Ω–æ?
- [ ] –û–±—Ä–∞–±–æ—Ç–∞–Ω—ã –∫—Ä–∞–π–Ω–∏–µ —Å–ª—É—á–∞–∏?
- [ ] –ü–æ–Ω—è—Ç–Ω—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è –æ–± –æ—à–∏–±–∫–∞—Ö?

**–ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å:**
- [ ] –ù–µ—Ç SQL injection?
- [ ] –ù–µ—Ç XSS —É—è–∑–≤–∏–º–æ—Å—Ç–µ–π?
- [ ] –°–µ–∫—Ä–µ—Ç—ã –Ω–µ –≤ –∫–æ–¥–µ?
- [ ] –í—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –≤–∞–ª–∏–¥–∏—Ä—É—é—Ç—Å—è?

**–ö–∞—á–µ—Å—Ç–≤–æ:**
- [ ] –ö–æ–¥ —á–∏—Ç–∞–µ–º—ã–π?
- [ ] –ù–µ—Ç –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏—è?
- [ ] –°–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç —Å—Ç–∏–ª—é –ø—Ä–æ–µ–∫—Ç–∞?

### –ö—Ä–∞—Å–Ω—ã–µ —Ñ–ª–∞–≥–∏

–ï—Å–ª–∏ –≤–∏–¥–∏—Ç–µ —ç—Ç–æ ‚Äî **—Å—Ä–∞–∑—É –ø—Ä–æ—Å–∏—Ç–µ –ø–µ—Ä–µ–ø–∏—Å–∞—Ç—å:**

\`\`\`javascript
// –û–ø–∞—Å–Ω–æ!
eval(userInput)
element.innerHTML = userData
query("SELECT * FROM users WHERE id = " + id)
localStorage.setItem('token', jwt)
\`\`\`

---

## –®–∞–≥ 5. –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä—É–π—Ç–µ

### –†—É—á–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –æ—Å–Ω–æ–≤–Ω–æ–π —Å—Ü–µ–Ω–∞—Ä–∏–π
- –ü–æ–ø—Ä–æ–±—É–π—Ç–µ —Å–ª–æ–º–∞—Ç—å (–ø—É—Å—Ç—ã–µ –¥–∞–Ω–Ω—ã–µ, —Å–ø–µ—Ü—Å–∏–º–≤–æ–ª—ã)
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –≥—Ä–∞–Ω–∏—á–Ω—ã–µ —Å–ª—É—á–∞–∏

### –ê–≤—Ç–æ—Ç–µ—Å—Ç—ã

–ü–æ–ø—Ä–æ—Å–∏—Ç–µ AI –Ω–∞–ø–∏—Å–∞—Ç—å —Ç–µ—Å—Ç—ã:

\`\`\`
"Unit —Ç–µ—Å—Ç—ã –¥–ª—è —ç—Ç–æ–π —Ñ—É–Ω–∫—Ü–∏–∏.
–ü–æ–∫—Ä–æ–π: —É—Å–ø–µ—à–Ω—ã–π —Å—Ü–µ–Ω–∞—Ä–∏–π, –ø—É—Å—Ç–æ–π input,
–Ω–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ, –≥—Ä–∞–Ω–∏—á–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è."
\`\`\`

---

## –®–∞–≥ 6. –ò–Ω—Ç–µ–≥—Ä–∏—Ä—É–π—Ç–µ

### –ü–µ—Ä–µ–¥ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–µ–π
- –ö–æ–¥ –ø—Ä–æ—Ö–æ–¥–∏—Ç –ª–∏–Ω—Ç–µ—Ä?
- –¢–µ—Å—Ç—ã –∑–µ–ª—ë–Ω—ã–µ?
- –ù—É–∂–µ–Ω code review?

### –ü—Ä–æ—Ü–µ—Å—Å
1. Feature branch
2. –î–æ–±–∞–≤–∏—Ç—å –∫–æ–¥
3. –ó–∞–ø—É—Å—Ç–∏—Ç—å —Ç–µ—Å—Ç—ã
4. Pull request
5. Code review
6. Merge

### –ü–æ—Å–ª–µ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏
- –°–ª–µ–¥–∏—Ç–µ –∑–∞ –ª–æ–≥–∞–º–∏ –æ—à–∏–±–æ–∫
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –º–µ—Ç—Ä–∏–∫–∏
- –ë—É–¥—å—Ç–µ –≥–æ—Ç–æ–≤—ã –æ—Ç–∫–∞—Ç–∏—Ç—å

---

## –†–µ–∑—é–º–µ

| –®–∞–≥ | –ß—Ç–æ –¥–µ–ª–∞—Ç—å |
|-----|------------|
| 1 | –°—Ñ–æ—Ä–º—É–ª–∏—Ä–æ–≤–∞—Ç—å –∑–∞–¥–∞—á—É |
| 2 | –î–æ–±–∞–≤–∏—Ç—å –∫–æ–Ω—Ç–µ–∫—Å—Ç |
| 3 | –ü–æ–ª—É—á–∏—Ç—å –∫–æ–¥ |
| 4 | –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å |
| 5 | –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å |
| 6 | –ò–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞—Ç—å |

---

## –ó–∞–¥–∞–Ω–∏–µ

–†–∞—Å—Å—Ç–∞–≤—å—Ç–µ —à–∞–≥–∏ –≤ –ø—Ä–∞–≤–∏–ª—å–Ω–æ–º –ø–æ—Ä—è–¥–∫–µ.`

    // =============================================
    // –ú–û–î–£–õ–¨ 3: –ê–Ω–∞–ª–∏–∑ –ø—Ä–æ–º–ø—Ç–æ–≤
    // =============================================
    const promptAnalysisContent = `# –ê–Ω–∞–ª–∏–∑ –ø—Ä–æ–º–ø—Ç–æ–≤

## –ì–ª–∞–≤–Ω–æ–µ –ø—Ä–∞–≤–∏–ª–æ

> **80% –∫–∞—á–µ—Å—Ç–≤–∞ –æ—Ç–≤–µ—Ç–∞ AI –∑–∞–≤–∏—Å–∏—Ç –æ—Ç –∫–∞—á–µ—Å—Ç–≤–∞ –≤–∞—à–µ–≥–æ –≤–æ–ø—Ä–æ—Å–∞.**

–û–¥–∏–Ω –∏ —Ç–æ—Ç –∂–µ AI –¥–∞—ë—Ç —Ä–∞–∑–Ω—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç –ø—Ä–æ–º–ø—Ç–∞. –ù–∞—É—á–∏—Ç–µ—Å—å –≤–∏–¥–µ—Ç—å –ø—Ä–æ–±–ª–µ–º—ã ‚Äî –ø–æ–ª—É—á–∏—Ç–µ —Ö–æ—Ä–æ—à–∏–π –∫–æ–¥.

---

## –°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ö–æ—Ä–æ—à–µ–≥–æ –ø—Ä–æ–º–ø—Ç–∞

–•–æ—Ä–æ—à–∏–π –ø—Ä–æ–º–ø—Ç —Å–æ–¥–µ—Ä–∂–∏—Ç **5 —ç–ª–µ–º–µ–Ω—Ç–æ–≤:**

### 1. –ö–æ–Ω—Ç–µ–∫—Å—Ç
\`\`\`
"–í –ø—Ä–æ–µ–∫—Ç–µ –Ω–∞ Next.js 14 —Å TypeScript..."
\`\`\`

### 2. –ó–∞–¥–∞—á–∞
\`\`\`
"...–Ω—É–∂–µ–Ω –∫–æ–º–ø–æ–Ω–µ–Ω—Ç –º–æ–¥–∞–ª—å–Ω–æ–≥–æ –æ–∫–Ω–∞..."
\`\`\`

### 3. –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è
\`\`\`
"...—Å –∞–Ω–∏–º–∞—Ü–∏–µ–π, –∫–Ω–æ–ø–∫–æ–π –∑–∞–∫—Ä—ã—Ç–∏—è,
–∑–∞—Ç–µ–º–Ω–µ–Ω–∏–µ–º —Ñ–æ–Ω–∞..."
\`\`\`

### 4. –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è
\`\`\`
"...–±–µ–∑ –≤–Ω–µ—à–Ω–∏—Ö –±–∏–±–ª–∏–æ—Ç–µ–∫,
—Ç–æ–ª—å–∫–æ CSS transitions..."
\`\`\`

### 5. –§–æ—Ä–º–∞—Ç –æ—Ç–≤–µ—Ç–∞
\`\`\`
"...–¥–∞–π –∫–æ–¥ –∏ –ø—Ä–∏–º–µ—Ä –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è"
\`\`\`

### –ü–æ–ª–Ω—ã–π –ø—Ä–æ–º–ø—Ç:

\`\`\`
–í –ø—Ä–æ–µ–∫—Ç–µ –Ω–∞ Next.js 14 —Å TypeScript –Ω—É–∂–µ–Ω
–∫–æ–º–ø–æ–Ω–µ–Ω—Ç –º–æ–¥–∞–ª—å–Ω–æ–≥–æ –æ–∫–Ω–∞ —Å –∞–Ω–∏–º–∞—Ü–∏–µ–π –ø–æ—è–≤–ª–µ–Ω–∏—è,
–∫–Ω–æ–ø–∫–æ–π –∑–∞–∫—Ä—ã—Ç–∏—è, –∑–∞—Ç–µ–º–Ω–µ–Ω–∏–µ–º —Ñ–æ–Ω–∞.

–û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è: –±–µ–∑ –±–∏–±–ª–∏–æ—Ç–µ–∫, —Ç–æ–ª—å–∫–æ CSS.

–î–∞–π –∫–æ–¥ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞ –∏ –ø—Ä–∏–º–µ—Ä –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è.
\`\`\`

---

## –¢–∏–ø–∏—á–Ω—ã–µ –æ—à–∏–±–∫–∏

### –û—à–∏–±–∫–∞ 1: –†–∞–∑–º—ã—Ç—ã–µ –∞–Ω–∞–ª–æ–≥–∏–∏

**–ü–ª–æ—Ö–æ:**
\`\`\`
"–°–¥–µ–ª–∞–π –∫–∞–∫ –≤ Notion"
\`\`\`

–ß—Ç–æ –∫–∞–∫ –≤ Notion? –†–µ–¥–∞–∫—Ç–æ—Ä? Sidebar? –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö? –°—Ç–∏–ª—å?

**–•–æ—Ä–æ—à–æ:**
\`\`\`
"Drag-and-drop —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞ –±–ª–æ–∫–æ–≤:
- –ü–µ—Ä–µ—Ç–∞—Å–∫–∏–≤–∞–Ω–∏–µ –∑–∞ –∏–∫–æ–Ω–∫—É —Å–ª–µ–≤–∞
- –í–∏–∑—É–∞–ª—å–Ω—ã–π –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä –ø–æ–∑–∏—Ü–∏–∏
- –ü–ª–∞–≤–Ω–∞—è –∞–Ω–∏–º–∞—Ü–∏—è"
\`\`\`

---

### –û—à–∏–±–∫–∞ 2: –°—É–±—ä–µ–∫—Ç–∏–≤–Ω—ã–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è

**–ü–ª–æ—Ö–æ:**
\`\`\`
"–°–¥–µ–ª–∞–π –∫—Ä–∞—Å–∏–≤—É—é —Ñ–æ—Ä–º—É"
"–°–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–π –¥–∏–∑–∞–π–Ω"
"–ö–∞–∫ –Ω–∞–¥–æ"
\`\`\`

**–•–æ—Ä–æ—à–æ:**
\`\`\`
"–§–æ—Ä–º–∞ –≤ —Å—Ç–∏–ª–µ –º–∏–Ω–∏–º–∞–ª–∏–∑–º:
- –ë–µ–ª—ã–π —Ñ–æ–Ω
- –°–µ—Ä—ã–µ –≥—Ä–∞–Ω–∏—Ü—ã 1px (#e5e7eb)
- –°–∏–Ω–∏–π focus (#3b82f6)
- –°–∫—Ä—É–≥–ª–µ–Ω–∏–µ 8px
- –û—Ç—Å—Ç—É–ø—ã 16px"
\`\`\`

---

### –û—à–∏–±–∫–∞ 3: –ù–µ—Ç —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–π

**–ü–ª–æ—Ö–æ:**
\`\`\`
"–ù–∞–ø–∏—à–∏ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—é"
\`\`\`

–ù–∞ —á—ë–º? Node? Python? PHP? –° –∫–∞–∫–æ–π –±–∞–∑–æ–π? JWT –∏–ª–∏ —Å–µ—Å—Å–∏–∏?

**–•–æ—Ä–æ—à–æ:**
\`\`\`
"API –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ –Ω–∞ Next.js:
- POST /api/auth/login
- Body: { email, password }
- –ë–∞–∑–∞: PostgreSQL —á–µ—Ä–µ–∑ Prisma
- –û—Ç–≤–µ—Ç: JWT —Ç–æ–∫–µ–Ω (jose)
- –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å httpOnly cookie"
\`\`\`

---

### –û—à–∏–±–∫–∞ 4: –ù–µ—Ç —Ä–æ–ª–µ–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π

**–ü–ª–æ—Ö–æ:**
\`\`\`
"–°–¥–µ–ª–∞–π –¥–∞—à–±–æ—Ä–¥"
\`\`\`

**–•–æ—Ä–æ—à–æ:**
\`\`\`
"–î–∞—à–±–æ—Ä–¥ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞ –º–∞–≥–∞–∑–∏–Ω–∞:
- –ó–∞–∫–∞–∑—ã –∑–∞ —Å–µ–≥–æ–¥–Ω—è (–∫–æ–ª-–≤–æ + —Å—É–º–º–∞)
- –ù–æ–≤—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –∑–∞ –Ω–µ–¥–µ–ª—é (–≥—Ä–∞—Ñ–∏–∫)
- –¢–æ–ø-5 —Ç–æ–≤–∞—Ä–æ–≤ –ø–æ –ø—Ä–æ–¥–∞–∂–∞–º
- –ó–∞–∫–∞–∑—ã —Å–æ —Å—Ç–∞—Ç—É—Å–æ–º pending"
\`\`\`

---

### –û—à–∏–±–∫–∞ 5: –ê–±—Å—Ç—Ä–∞–∫—Ç–Ω—ã–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è

**–ü–ª–æ—Ö–æ:**
\`\`\`
"–ò—Å–ø–æ–ª—å–∑—É–π –ª—É—á—à–∏–µ –ø—Ä–∞–∫—Ç–∏–∫–∏"
\`\`\`

**–•–æ—Ä–æ—à–æ:**
\`\`\`
"–¢—Ä–µ–±–æ–≤–∞–Ω–∏—è –∫ –∫–æ–¥—É:
- TypeScript —Ç–∏–ø—ã –¥–ª—è –≤—Å–µ—Ö —Ñ—É–Ω–∫—Ü–∏–π
- –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫ try/catch
- –í–∞–ª–∏–¥–∞—Ü–∏—è —á–µ—Ä–µ–∑ Zod
- JSDoc –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏
- –ö–æ–Ω—Å—Ç–∞–Ω—Ç—ã –≤–º–µ—Å—Ç–æ magic numbers"
\`\`\`

---

## –®–∞–±–ª–æ–Ω—ã –ø—Ä–æ–º–ø—Ç–æ–≤

### –î–ª—è –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞

\`\`\`
[–°—Ç–µ–∫: Next.js + TypeScript + Tailwind]

–ö–æ–º–ø–æ–Ω–µ–Ω—Ç [–ù–∞–∑–≤–∞–Ω–∏–µ]:
- Props: [—Å–ø–∏—Å–æ–∫ —Å —Ç–∏–ø–∞–º–∏]
- –§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å: [–æ–ø–∏—Å–∞–Ω–∏–µ]
- –°—Ç–∏–ª–∏: [—Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è]
- –°–æ—Å—Ç–æ—è–Ω–∏—è: hover, active, disabled
- –î–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å: [—Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è]

–î–∞–π –∫–æ–¥ –∏ –ø—Ä–∏–º–µ—Ä –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è.
\`\`\`

### –î–ª—è API

\`\`\`
[–°—Ç–µ–∫: —Ñ—Ä–µ–π–º–≤–æ—Ä–∫ + –ë–î + ORM]

API endpoint [–º–µ—Ç–æ–¥] [–ø—É—Ç—å]:
- –ü–∞—Ä–∞–º–µ—Ç—Ä—ã: [—Å–ø–∏—Å–æ–∫ —Å —Ç–∏–ø–∞–º–∏]
- –í–∞–ª–∏–¥–∞—Ü–∏—è: [–ø—Ä–∞–≤–∏–ª–∞]
- –õ–æ–≥–∏–∫–∞: [–æ–ø–∏—Å–∞–Ω–∏–µ]
- –û—Ç–≤–µ—Ç: [—Ñ–æ—Ä–º–∞—Ç]
- –û—à–∏–±–∫–∏: [–∫–∞–∫–∏–µ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—Ç—å]
\`\`\`

### –î–ª—è —Ñ—É–Ω–∫—Ü–∏–∏

\`\`\`
–§—É–Ω–∫—Ü–∏—è [–Ω–∞–∑–≤–∞–Ω–∏–µ]:
- Input: [–ø–∞—Ä–∞–º–µ—Ç—Ä—ã]
- Output: [—Ä–µ–∑—É–ª—å—Ç–∞—Ç]
- –õ–æ–≥–∏–∫–∞: [–æ–ø–∏—Å–∞–Ω–∏–µ]
- Edge cases: [—Å–ø–∏—Å–æ–∫]
- –ü—Ä–∏–º–µ—Ä –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è
\`\`\`

---

## –ö–ª—é—á–µ–≤—ã–µ –≤—ã–≤–æ–¥—ã

1. **–ö–æ–Ω–∫—Ä–µ—Ç–∏–∫–∞ > –∞–±—Å—Ç—Ä–∞–∫—Ü–∏–∏.** "–ö—Ä–∞—Å–∏–≤–æ" ‚Äî –ø–ª–æ—Ö–æ. "–°–∏–Ω–∏–π #3b82f6" ‚Äî —Ö–æ—Ä–æ—à–æ.
2. **–ö–æ–Ω—Ç–µ–∫—Å—Ç –æ–±—è–∑–∞—Ç–µ–ª–µ–Ω.** AI –Ω–µ –∑–Ω–∞–µ—Ç –≤–∞—à –ø—Ä–æ–µ–∫—Ç.
3. **–û–¥–∏–Ω –ø—Ä–æ–º–ø—Ç ‚Äî –æ–¥–Ω–∞ –∑–∞–¥–∞—á–∞.** –ù–µ –ø—Ä–æ—Å–∏—Ç–µ –≤—Å—ë —Å—Ä–∞–∑—É.
4. **–£–∫–∞–∑—ã–≤–∞–π—Ç–µ —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–∏.** –ò–Ω–∞—á–µ AI –≤—ã–±–µ—Ä–µ—Ç —Å–∞–º.
5. **–û–ø–∏—Å—ã–≤–∞–π—Ç–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π.** –ö—Ç–æ –±—É–¥–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å?

---

## –ó–∞–¥–∞–Ω–∏–µ

–ü—Ä–æ–∞–Ω–∞–ª–∏–∑–∏—Ä—É–π—Ç–µ –ø—Ä–æ–º–ø—Ç –∏ –Ω–∞–π–¥–∏—Ç–µ –≤—Å–µ –ø—Ä–æ–±–ª–µ–º—ã.

–ü–æ–º–Ω–∏—Ç–µ: –∫–∞–∂–¥–∞—è –Ω–µ—Ç–æ—á–Ω–æ—Å—Ç—å = AI —Ä–µ—à–∏—Ç —Å–∞–º. –ò —Å–∫–æ—Ä–µ–µ –≤—Å–µ–≥–æ –Ω–µ —Ç–∞–∫, –∫–∞–∫ –≤—ã —Ö–æ—Ç–µ–ª–∏.`

    // Update module contents
    const rolesModule = await prisma.module.findFirst({
      where: { title: "–†–æ–ª–∏ –≤ Vibe Coding" },
    })
    if (rolesModule) {
      await prisma.module.update({
        where: { id: rolesModule.id },
        data: { content: rolesContent },
      })
    }

    const workflowModule = await prisma.module.findFirst({
      where: { title: "–ü–æ—Ä—è–¥–æ–∫ —Ä–∞–±–æ—Ç—ã —Å AI" },
    })
    if (workflowModule) {
      await prisma.module.update({
        where: { id: workflowModule.id },
        data: { content: workflowContent },
      })
    }

    const analysisModule = await prisma.module.findFirst({
      where: { title: "–ê–Ω–∞–ª–∏–∑ –ø—Ä–æ–º–ø—Ç–æ–≤" },
    })
    if (analysisModule) {
      await prisma.module.update({
        where: { id: analysisModule.id },
        data: { content: promptAnalysisContent },
      })
    }

    return NextResponse.json({
      success: true,
      message: "–ö–æ–Ω—Ç–µ–Ω—Ç –º–æ–¥—É–ª–µ–π –æ–±–Ω–æ–≤–ª—ë–Ω",
      updated: {
        roles: !!rolesModule,
        workflow: !!workflowModule,
        analysis: !!analysisModule,
      },
    })
  } catch (error) {
    console.error("Content update error:", error)
    return NextResponse.json({ error: "–û—à–∏–±–∫–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –∫–æ–Ω—Ç–µ–Ω—Ç–∞" }, { status: 500 })
  }
}
