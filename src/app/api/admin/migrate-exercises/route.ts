import { NextResponse } from "next/server"
import { getServerSession } from "next-auth"
import { authOptions } from "@/lib/auth"
import { prisma } from "@/lib/prisma"

// One-time migration to add new interactive practice modules
export async function POST() {
  try {
    const session = await getServerSession(authOptions)

    if (!session?.user?.id || session.user.role !== "ADMIN") {
      return NextResponse.json({ error: "–¢–æ–ª—å–∫–æ –∞–¥–º–∏–Ω" }, { status: 403 })
    }

    // Find Vibe Coder trail
    const vibeCoder = await prisma.trail.findUnique({
      where: { slug: "vibe-coder" },
    })

    if (!vibeCoder) {
      return NextResponse.json({ error: "Trail vibe-coder –Ω–µ –Ω–∞–π–¥–µ–Ω" }, { status: 404 })
    }

    // Check if modules already exist
    const existingModule = await prisma.module.findFirst({
      where: { slug: { startsWith: "vibe-roles-practice" } },
    })

    if (existingModule) {
      return NextResponse.json({ message: "–ú–æ–¥—É–ª–∏ —É–∂–µ —Å—É—â–µ—Å—Ç–≤—É—é—Ç", skipped: true })
    }

    // Get current max order
    const maxOrder = await prisma.module.aggregate({
      where: { trailId: vibeCoder.id },
      _max: { order: true },
    })
    let order = (maxOrder._max.order || 0) + 1

    // Create 3 new practice modules
    const newModules = [
      {
        slug: `vibe-roles-practice-${Date.now()}`,
        title: "–†–æ–ª–∏ –≤ Vibe Coding",
        description: "–°–æ–ø–æ—Å—Ç–∞–≤—å—Ç–µ —Ä–æ–ª–∏ AI –∏ —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–∞ —Å –∏—Ö –∑–∞–¥–∞—á–∞–º–∏",
        type: "PRACTICE",
        level: "Beginner",
        points: 60,
        duration: "10 –º–∏–Ω",
        order: order++,
        content: `# –†–æ–ª–∏ –≤ Vibe Coding

–í Vibe Coding –∫–∞–∂–¥—ã–π —É—á–∞—Å—Ç–Ω–∏–∫ –ø—Ä–æ—Ü–µ—Å—Å–∞ –≤—ã–ø–æ–ª–Ω—è–µ—Ç —Å–≤–æ—é —Ä–æ–ª—å. –†–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫ –∏ AI —Ä–∞–±–æ—Ç–∞—é—Ç –≤ –∫–æ–º–∞–Ω–¥–µ, –Ω–æ —É –∫–∞–∂–¥–æ–≥–æ —Å–≤–æ–∏ –∑–∞–¥–∞—á–∏.

## –†–æ–ª—å AI
- –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –∫–æ–¥–∞ –ø–æ –æ–ø–∏—Å–∞–Ω–∏—é
- –†—É—Ç–∏–Ω–Ω—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ (—Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ, —Ä–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥)
- –ü—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–µ —Ä–µ—à–µ–Ω–∏–π –∏ –ø–∞—Ç—Ç–µ—Ä–Ω–æ–≤
- –û—Ç–≤–µ—Ç—ã –Ω–∞ —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –≤–æ–ø—Ä–æ—Å—ã

## –†–æ–ª—å —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–∞
- –§–æ—Ä–º—É–ª–∏—Ä–æ–≤–∫–∞ –∑–∞–¥–∞—á –∏ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏–π
- –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–∞—á–µ—Å—Ç–≤–∞ –∏ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ –∫–æ–¥–∞
- –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω—ã–µ —Ä–µ—à–µ–Ω–∏—è
- –§–∏–Ω–∞–ª—å–Ω–∞—è –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç—å –∑–∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç

## –ó–∞–¥–∞–Ω–∏–µ
–°–æ–µ–¥–∏–Ω–∏—Ç–µ –∫–∞–∂–¥—É—é –∑–∞–¥–∞—á—É —Å –ø—Ä–∞–≤–∏–ª—å–Ω–æ–π —Ä–æ–ª—å—é.`,
        trailId: vibeCoder.id,
        questionType: "MATCHING",
        questionText: "–°–æ–µ–¥–∏–Ω–∏—Ç–µ –∫–∞–∂–¥—É—é –∑–∞–¥–∞—á—É —Å –ø—Ä–∞–≤–∏–ª—å–Ω–æ–π —Ä–æ–ª—å—é",
        questionData: {
          leftItems: [
            { id: "l1", text: "–ì–µ–Ω–µ—Ä–∞—Ü–∏—è –∫–æ–¥–∞ –ø–æ –æ–ø–∏—Å–∞–Ω–∏—é" },
            { id: "l2", text: "–ü—Ä–æ–≤–µ—Ä–∫–∞ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ –∫–æ–¥–∞" },
            { id: "l3", text: "–†—É—Ç–∏–Ω–Ω—ã–π —Ä–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥" },
            { id: "l4", text: "–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω—ã–µ —Ä–µ—à–µ–Ω–∏—è" },
            { id: "l5", text: "–ü—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–µ –ø–∞—Ç—Ç–µ—Ä–Ω–æ–≤" },
            { id: "l6", text: "–§–∏–Ω–∞–ª—å–Ω–∞—è –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç—å" },
          ],
          rightItems: [
            { id: "r1", text: "ü§ñ AI" },
            { id: "r2", text: "üë®‚Äçüíª –†–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫" },
          ],
          correctPairs: {
            l1: "r1",
            l2: "r2",
            l3: "r1",
            l4: "r2",
            l5: "r1",
            l6: "r2",
          },
        },
      },
      {
        slug: `vibe-workflow-practice-${Date.now()}`,
        title: "–ü–æ—Ä—è–¥–æ–∫ —Ä–∞–±–æ—Ç—ã —Å AI",
        description: "–†–∞—Å—Å—Ç–∞–≤—å—Ç–µ —à–∞–≥–∏ —Ä–∞–±–æ—Ç—ã —Å AI –≤ –ø—Ä–∞–≤–∏–ª—å–Ω–æ–º –ø–æ—Ä—è–¥–∫–µ",
        type: "PRACTICE",
        level: "Beginner",
        points: 60,
        duration: "10 –º–∏–Ω",
        order: order++,
        content: `# –ü–æ—Ä—è–¥–æ–∫ —Ä–∞–±–æ—Ç—ã —Å AI

–≠—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–∞—è —Ä–∞–±–æ—Ç–∞ —Å AI —Ç—Ä–µ–±—É–µ—Ç –ø—Ä–∞–≤–∏–ª—å–Ω–æ–π –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ –¥–µ–π—Å—Ç–≤–∏–π. –ï—Å–ª–∏ –ø—Ä–æ–ø—É—Å—Ç–∏—Ç—å —à–∞–≥–∏ –∏–ª–∏ –∏–∑–º–µ–Ω–∏—Ç—å –ø–æ—Ä—è–¥–æ–∫ ‚Äî —Ä–µ–∑—É–ª—å—Ç–∞—Ç –±—É–¥–µ—Ç —Ö—É–∂–µ.

## –ö–ª—é—á–µ–≤—ã–µ —ç—Ç–∞–ø—ã

1. **–ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞** ‚Äî —á—ë—Ç–∫–æ —Å—Ñ–æ—Ä–º—É–ª–∏—Ä—É–π—Ç–µ, —á—Ç–æ –≤–∞–º –Ω—É–∂–Ω–æ
2. **–ö–æ–Ω—Ç–µ–∫—Å—Ç** ‚Äî –ø—Ä–µ–¥–æ—Å—Ç–∞–≤—å—Ç–µ AI –≤—Å—é –Ω–µ–æ–±—Ö–æ–¥–∏–º—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é
3. **–ì–µ–Ω–µ—Ä–∞—Ü–∏—è** ‚Äî –ø–æ–ª—É—á–∏—Ç–µ –∫–æ–¥ –æ—Ç AI
4. **–ü—Ä–æ–≤–µ—Ä–∫–∞** ‚Äî –ø—Ä–æ–∞–Ω–∞–ª–∏–∑–∏—Ä—É–π—Ç–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç –Ω–∞ –æ—à–∏–±–∫–∏
5. **–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ** ‚Äî —É–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –∫–æ–¥ —Ä–∞–±–æ—Ç–∞–µ—Ç
6. **–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è** ‚Äî –¥–æ–±–∞–≤—å—Ç–µ –∫–æ–¥ –≤ –ø—Ä–æ–µ–∫—Ç

## –ó–∞–¥–∞–Ω–∏–µ
–†–∞—Å—Å—Ç–∞–≤—å—Ç–µ —à–∞–≥–∏ –≤ –ø—Ä–∞–≤–∏–ª—å–Ω–æ–º –ø–æ—Ä—è–¥–∫–µ.`,
        trailId: vibeCoder.id,
        questionType: "ORDERING",
        questionText: "–†–∞—Å—Å—Ç–∞–≤—å—Ç–µ —à–∞–≥–∏ —Ä–∞–±–æ—Ç—ã —Å AI –≤ –ø—Ä–∞–≤–∏–ª—å–Ω–æ–º –ø–æ—Ä—è–¥–∫–µ",
        questionData: {
          items: [
            { id: "s1", text: "–°—Ñ–æ—Ä–º—É–ª–∏—Ä–æ–≤–∞—Ç—å —á—ë—Ç–∫—É—é –∑–∞–¥–∞—á—É" },
            { id: "s2", text: "–î–æ–±–∞–≤–∏—Ç—å –∫–æ–Ω—Ç–µ–∫—Å—Ç –∏ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è" },
            { id: "s3", text: "–ü–æ–ª—É—á–∏—Ç—å –∫–æ–¥ –æ—Ç AI" },
            { id: "s4", text: "–ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∫–æ–¥ –Ω–∞ –æ—à–∏–±–∫–∏ –∏ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å" },
            { id: "s5", text: "–ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å —Ä–∞–±–æ—Ç—É –∫–æ–¥–∞" },
            { id: "s6", text: "–ò–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞—Ç—å –≤ –ø—Ä–æ–µ–∫—Ç" },
          ],
          correctOrder: ["s1", "s2", "s3", "s4", "s5", "s6"],
        },
      },
      {
        slug: `vibe-prompt-analysis-${Date.now()}`,
        title: "–ê–Ω–∞–ª–∏–∑ –ø—Ä–æ–º–ø—Ç–æ–≤",
        description: "–ù–∞–π–¥–∏—Ç–µ –æ—à–∏–±–∫–∏ –≤ –ø–ª–æ—Ö–∏—Ö –ø—Ä–æ–º–ø—Ç–∞—Ö",
        type: "PRACTICE",
        level: "Intermediate",
        points: 75,
        duration: "15 –º–∏–Ω",
        order: order++,
        content: `# –ê–Ω–∞–ª–∏–∑ –ø—Ä–æ–º–ø—Ç–æ–≤

–ö–∞—á–µ—Å—Ç–≤–æ –ø—Ä–æ–º–ø—Ç–∞ –Ω–∞–ø—Ä—è–º—É—é –≤–ª–∏—è–µ—Ç –Ω–∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç. –ü–ª–æ—Ö–æ–π –ø—Ä–æ–º–ø—Ç ‚Üí –ø–ª–æ—Ö–æ–π –∫–æ–¥. –ù–∞—É—á–∏—Ç–µ—Å—å –≤–∏–¥–µ—Ç—å –ø—Ä–æ–±–ª–µ–º—ã –≤ –ø—Ä–æ–º–ø—Ç–∞—Ö.

## –ü—Ä–∏–∑–Ω–∞–∫–∏ –ø–ª–æ—Ö–æ–≥–æ –ø—Ä–æ–º–ø—Ç–∞

- –°–ª–∏—à–∫–æ–º –∫–æ—Ä–æ—Ç–∫–∏–π –∏–ª–∏ —Ä–∞—Å–ø–ª—ã–≤—á–∞—Ç—ã–π
- –ù–µ—Ç –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞ (–∫–∞–∫–æ–π –ø—Ä–æ–µ–∫—Ç, –∫–∞–∫–∏–µ —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–∏)
- –ù–µ—Ç –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–π (–±–µ–∑ –±–∏–±–ª–∏–æ—Ç–µ–∫, —Å TypeScript –∏ —Ç.–¥.)
- –ù–µ—Ç —á—ë—Ç–∫–æ–π –∑–∞–¥–∞—á–∏
- –ù–µ—Ç —Ä–æ–ª–∏ –¥–ª—è AI

## –ü—Ä–∏–º–µ—Ä –ø–ª–æ—Ö–æ–≥–æ –ø—Ä–æ–º–ø—Ç–∞

> "—Å–¥–µ–ª–∞–π —Ñ–æ—Ä–º—É"

–ß—Ç–æ –Ω–µ —Ç–∞–∫:
- –ö–∞–∫—É—é —Ñ–æ—Ä–º—É? –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏? –í—Ö–æ–¥–∞? –û–±—Ä–∞—Ç–Ω–æ–π —Å–≤—è–∑–∏?
- –ù–∞ —á—ë–º? React? Vue? Vanilla JS?
- –ö–∞–∫–∏–µ –ø–æ–ª—è? –ö–∞–∫–∞—è –≤–∞–ª–∏–¥–∞—Ü–∏—è?
- –ö—É–¥–∞ –æ—Ç–ø—Ä–∞–≤–ª—è—Ç—å –¥–∞–Ω–Ω—ã–µ?

## –ó–∞–¥–∞–Ω–∏–µ
–ü—Ä–æ–∞–Ω–∞–ª–∏–∑–∏—Ä—É–π—Ç–µ –ø—Ä–æ–º–ø—Ç –∏ –Ω–∞–π–¥–∏—Ç–µ –≤—Å–µ –ø—Ä–æ–±–ª–µ–º—ã.`,
        trailId: vibeCoder.id,
        questionType: "CASE_ANALYSIS",
        questionText: "–ù–∞–π–¥–∏—Ç–µ –≤—Å–µ –ø—Ä–æ–±–ª–µ–º—ã –≤ —ç—Ç–æ–º –ø—Ä–æ–º–ø—Ç–µ",
        questionData: {
          caseContent: "–Ω–∞–ø–∏—à–∏ –º–Ω–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ",
          caseLabel: "–ü—Ä–æ–º–ø—Ç",
          options: [
            {
              id: "o1",
              text: "–ù–µ—Ç –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞ ‚Äî –Ω–µ–ø–æ–Ω—è—Ç–Ω–æ, –∫–∞–∫–æ–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –Ω—É–∂–Ω–æ",
              isCorrect: true,
              explanation: "AI –Ω–µ –∑–Ω–∞–µ—Ç, –Ω—É–∂–Ω–æ –≤–µ–±, –º–æ–±–∏–ª—å–Ω–æ–µ –∏–ª–∏ –¥–µ—Å–∫—Ç–æ–ø –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ",
            },
            {
              id: "o2",
              text: "–ù–µ—Ç —É–∫–∞–∑–∞–Ω–∏—è —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–π ‚Äî –Ω–µ–ø–æ–Ω—è—Ç–Ω–æ, –Ω–∞ —á—ë–º –ø–∏—Å–∞—Ç—å",
              isCorrect: true,
              explanation: "React? Vue? Python? Swift? –ë–µ–∑ —ç—Ç–æ–≥–æ AI –≤—ã–±–µ—Ä–µ—Ç —Å–∞–º",
            },
            {
              id: "o3",
              text: "–ù–µ—Ç —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω—ã—Ö —Ç—Ä–µ–±–æ–≤–∞–Ω–∏–π ‚Äî —á—Ç–æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –¥–æ–ª–∂–Ω–æ –¥–µ–ª–∞—Ç—å?",
              isCorrect: true,
              explanation: "–ö–∞–ª—å–∫—É–ª—è—Ç–æ—Ä? –ß–∞—Ç? –ú–∞–≥–∞–∑–∏–Ω? –ù—É–∂–Ω–æ –æ–ø–∏—Å–∞—Ç—å —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª",
            },
            {
              id: "o4",
              text: "–ù–µ—Ç —Ä–æ–ª–∏ –¥–ª—è AI ‚Äî –æ–Ω –Ω–µ –∑–Ω–∞–µ—Ç, –∫–∞–∫ —Å–µ–±—è –≤–µ—Å—Ç–∏",
              isCorrect: true,
              explanation: "–†–æ–ª—å –ø–æ–º–æ–≥–∞–µ—Ç AI –ø–æ–Ω—è—Ç—å —É—Ä–æ–≤–µ–Ω—å –æ—Ç–≤–µ—Ç–∞ (–¥–∂—É–Ω–∏–æ—Ä vs —Å–µ–Ω—å–æ—Ä)",
            },
            {
              id: "o5",
              text: "–°–ª–∏—à–∫–æ–º –º–Ω–æ–≥–æ –¥–µ—Ç–∞–ª–µ–π –ø–µ—Ä–µ–≥—Ä—É–∂–∞—é—Ç AI",
              isCorrect: false,
              explanation: "–ù–∞–æ–±–æ—Ä–æ—Ç, –≤ —ç—Ç–æ–º –ø—Ä–æ–º–ø—Ç–µ –Ω–µ —Ö–≤–∞—Ç–∞–µ—Ç –¥–µ—Ç–∞–ª–µ–π",
            },
            {
              id: "o6",
              text: "–ü—Ä–æ–º–ø—Ç –Ω–∞–ø–∏—Å–∞–Ω –Ω–∞ —Ä—É—Å—Å–∫–æ–º, –∞ –Ω–∞–¥–æ –Ω–∞ –∞–Ω–≥–ª–∏–π—Å–∫–æ–º",
              isCorrect: false,
              explanation: "–°–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–µ AI –æ—Ç–ª–∏—á–Ω–æ –ø–æ–Ω–∏–º–∞—é—Ç —Ä—É—Å—Å–∫–∏–π —è–∑—ã–∫",
            },
          ],
          minCorrectRequired: 3,
        },
      },
    ]

    const createdModules = []

    for (const mod of newModules) {
      const { questionType, questionText, questionData, ...moduleData } = mod

      // Create module
      const createdModule = await prisma.module.create({
        data: moduleData,
      })

      // Create question for this module
      await prisma.question.create({
        data: {
          moduleId: createdModule.id,
          type: questionType,
          question: questionText,
          options: JSON.stringify([]),
          correctAnswer: 0,
          data: JSON.stringify(questionData),
          order: 1,
        },
      })

      createdModules.push(createdModule.title)
    }

    return NextResponse.json({
      success: true,
      message: "–ú–æ–¥—É–ª–∏ —É—Å–ø–µ—à–Ω–æ –¥–æ–±–∞–≤–ª–µ–Ω—ã",
      modules: createdModules,
    })
  } catch (error) {
    console.error("Migration error:", error)
    return NextResponse.json({ error: "–û—à–∏–±–∫–∞ –º–∏–≥—Ä–∞—Ü–∏–∏" }, { status: 500 })
  }
}

// GET - Check status
export async function GET() {
  try {
    const session = await getServerSession(authOptions)

    if (!session?.user?.id || session.user.role !== "ADMIN") {
      return NextResponse.json({ error: "–¢–æ–ª—å–∫–æ –∞–¥–º–∏–Ω" }, { status: 403 })
    }

    const existingModule = await prisma.module.findFirst({
      where: {
        OR: [
          { slug: { startsWith: "vibe-roles-practice" } },
          { title: "–†–æ–ª–∏ –≤ Vibe Coding" },
        ]
      },
    })

    return NextResponse.json({
      migrated: !!existingModule,
      module: existingModule?.title || null,
    })
  } catch (error) {
    console.error("Check error:", error)
    return NextResponse.json({ error: "–û—à–∏–±–∫–∞ –ø—Ä–æ–≤–µ—Ä–∫–∏" }, { status: 500 })
  }
}

// PATCH - Update existing exercise data (fix emojis, etc.)
export async function PATCH() {
  try {
    const session = await getServerSession(authOptions)

    if (!session?.user?.id || session.user.role !== "ADMIN") {
      return NextResponse.json({ error: "–¢–æ–ª—å–∫–æ –∞–¥–º–∏–Ω" }, { status: 403 })
    }

    // Find the matching exercise module
    const matchingModule = await prisma.module.findFirst({
      where: { title: "–†–æ–ª–∏ –≤ Vibe Coding" },
      include: { questions: true },
    })

    if (matchingModule && matchingModule.questions.length > 0) {
      const updatedMatchingData = {
        leftLabel: "–ó–∞–¥–∞—á–∏",
        rightLabel: "–ò—Å–ø–æ–ª–Ω–∏—Ç–µ–ª—å",
        leftItems: [
          { id: "l1", text: "–ì–µ–Ω–µ—Ä–∞—Ü–∏—è –∫–æ–¥–∞ –ø–æ –æ–ø–∏—Å–∞–Ω–∏—é" },
          { id: "l2", text: "–ü—Ä–æ–≤–µ—Ä–∫–∞ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ –∫–æ–¥–∞" },
          { id: "l3", text: "–†—É—Ç–∏–Ω–Ω—ã–π —Ä–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥" },
          { id: "l4", text: "–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω—ã–µ —Ä–µ—à–µ–Ω–∏—è" },
          { id: "l5", text: "–ü—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–µ –ø–∞—Ç—Ç–µ—Ä–Ω–æ–≤" },
          { id: "l6", text: "–§–∏–Ω–∞–ª—å–Ω–∞—è –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç—å" },
        ],
        rightItems: [
          { id: "r1", text: "AI" },
          { id: "r2", text: "–†–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫" },
        ],
        correctPairs: {
          l1: "r1",
          l2: "r2",
          l3: "r1",
          l4: "r2",
          l5: "r1",
          l6: "r2",
        },
      }

      await prisma.question.update({
        where: { id: matchingModule.questions[0].id },
        data: { data: JSON.stringify(updatedMatchingData) },
      })
    }

    // Find and fix case analysis module
    const caseModule = await prisma.module.findFirst({
      where: { title: "–ê–Ω–∞–ª–∏–∑ –ø—Ä–æ–º–ø—Ç–æ–≤" },
      include: { questions: true },
    })

    if (caseModule && caseModule.questions.length > 0) {
      const updatedCaseData = {
        caseContent: `–ü—Ä–∏–≤–µ—Ç! –ú–Ω–µ –Ω—É–∂–Ω–æ —Å–¥–µ–ª–∞—Ç—å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ —Ç–∏–ø–∞ Uber, —Ç–æ–ª—å–∫–æ –¥–ª—è –¥–æ—Å—Ç–∞–≤–∫–∏ –µ–¥—ã. –°–¥–µ–ª–∞–π –∫—Ä–∞—Å–∏–≤—ã–π —Å–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–π –¥–∏–∑–∞–π–Ω. –ù—É–∂–Ω–æ —á—Ç–æ–±—ã —Ä–∞–±–æ—Ç–∞–ª–æ –±—ã—Å—Ç—Ä–æ –∏ –±–µ–∑ –±–∞–≥–æ–≤. –ò—Å–ø–æ–ª—å–∑—É–π –ª—É—á—à–∏–µ –ø—Ä–∞–∫—Ç–∏–∫–∏. –ë—é–¥–∂–µ—Ç –Ω–µ–±–æ–ª—å—à–æ–π, –ø–æ—ç—Ç–æ–º—É —Å–¥–µ–ª–∞–π –ø–æ–ø—Ä–æ—â–µ.`,
        caseLabel: "–ü—Ä–æ–º–ø—Ç –æ—Ç –∑–∞–∫–∞–∑—á–∏–∫–∞",
        options: [
          {
            id: "o1",
            text: "¬´–¢–∏–ø–∞ Uber¬ª ‚Äî —Å–ª–∏—à–∫–æ–º —Ä–∞–∑–º—ã—Ç–∞—è –∞–Ω–∞–ª–æ–≥–∏—è",
            isCorrect: true,
            explanation: "Uber –∏–º–µ–µ—Ç —Å–æ—Ç–Ω–∏ —Ñ—É–Ω–∫—Ü–∏–π. –ö–∞–∫–∏–µ –∏–º–µ–Ω–Ω–æ –Ω—É–∂–Ω—ã? –ö–∞—Ä—Ç–∞? –†–µ–π—Ç–∏–Ω–≥–∏? –ß–∞—Ç? –û–ø–ª–∞—Ç–∞?",
          },
          {
            id: "o2",
            text: "¬´–ö—Ä–∞—Å–∏–≤—ã–π –¥–∏–∑–∞–π–Ω¬ª ‚Äî —Å—É–±—ä–µ–∫—Ç–∏–≤–Ω–æ–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏–µ",
            isCorrect: true,
            explanation: "–ß—Ç–æ —Ç–∞–∫–æ–µ ¬´–∫—Ä–∞—Å–∏–≤–æ¬ª? –ù—É–∂–Ω—ã –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–µ —Ä–µ—Ñ–µ—Ä–µ–Ω—Å—ã, —Ü–≤–µ—Ç–∞, —Å—Ç–∏–ª—å",
          },
          {
            id: "o3",
            text: "–ù–µ —É–∫–∞–∑–∞–Ω–∞ –ø–ª–∞—Ç—Ñ–æ—Ä–º–∞ ‚Äî –≤–µ–±, iOS –∏–ª–∏ Android?",
            isCorrect: true,
            explanation: "–†–∞–∑–Ω—ã–µ –ø–ª–∞—Ç—Ñ–æ—Ä–º—ã = —Ä–∞–∑–Ω—ã–µ —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–∏ –∏ –ø–æ–¥—Ö–æ–¥—ã. –≠—Ç–æ –∫—Ä–∏—Ç–∏—á–Ω–æ",
          },
          {
            id: "o4",
            text: "–ù–µ—Ç –æ–ø–∏—Å–∞–Ω–∏—è —Ä–æ–ª–µ–π ‚Äî –∫—Ç–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ —Å–∏—Å—Ç–µ–º—ã?",
            isCorrect: true,
            explanation: "–ö–ª–∏–µ–Ω—Ç? –ö—É—Ä—å–µ—Ä? –†–µ—Å—Ç–æ—Ä–∞–Ω? –ê–¥–º–∏–Ω? –£ –∫–∞–∂–¥–æ–≥–æ —Å–≤–æ–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å",
          },
          {
            id: "o5",
            text: "¬´–õ—É—á—à–∏–µ –ø—Ä–∞–∫—Ç–∏–∫–∏¬ª ‚Äî –Ω–µ–ø–æ–Ω—è—Ç–Ω–æ –∫–∞–∫–∏–µ –∏–º–µ–Ω–Ω–æ",
            isCorrect: true,
            explanation: "–õ—É—á—à–∏–µ –ø—Ä–∞–∫—Ç–∏–∫–∏ —á–µ–≥–æ? –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏? UX? –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏? –ù—É–∂–Ω–∞ –∫–æ–Ω–∫—Ä–µ—Ç–∏–∫–∞",
          },
          {
            id: "o6",
            text: "–ü—Ä–æ–º–ø—Ç —Å–ª–∏—à–∫–æ–º –¥–ª–∏–Ω–Ω—ã–π –¥–ª—è AI",
            isCorrect: false,
            explanation: "–î–ª–∏–Ω–∞ –ø—Ä–æ–º–ø—Ç–∞ –Ω–µ –ø—Ä–æ–±–ª–µ–º–∞. AI —Å–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è —Å –±–æ–ª—å—à–∏–º–∏ —Ç–µ–∫—Å—Ç–∞–º–∏",
          },
          {
            id: "o7",
            text: "–ù–µ–ª—å–∑—è —É–ø–æ–º–∏–Ω–∞—Ç—å –±—é–¥–∂–µ—Ç –≤ –ø—Ä–æ–º–ø—Ç–µ",
            isCorrect: false,
            explanation: "–ë—é–¥–∂–µ—Ç –º–æ–∂–Ω–æ —É–ø–æ–º–∏–Ω–∞—Ç—å, –Ω–æ —ç—Ç–æ –Ω–µ –∑–∞–º–µ–Ω—è–µ—Ç —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∏—Ö —Ç—Ä–µ–±–æ–≤–∞–Ω–∏–π",
          },
        ],
        minCorrectRequired: 4,
      }

      await prisma.question.update({
        where: { id: caseModule.questions[0].id },
        data: { data: JSON.stringify(updatedCaseData) },
      })
    }

    return NextResponse.json({
      success: true,
      message: "–î–∞–Ω–Ω—ã–µ –æ–±–Ω–æ–≤–ª–µ–Ω—ã",
    })
  } catch (error) {
    console.error("Update error:", error)
    return NextResponse.json({ error: "–û—à–∏–±–∫–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è" }, { status: 500 })
  }
}

// PUT - Update module content with rich educational material
export async function PUT() {
  try {
    const session = await getServerSession(authOptions)

    if (!session?.user?.id || session.user.role !== "ADMIN") {
      return NextResponse.json({ error: "–¢–æ–ª—å–∫–æ –∞–¥–º–∏–Ω" }, { status: 403 })
    }

    // Rich content for "–†–æ–ª–∏ –≤ Vibe Coding"
    const rolesContent = `# –†–æ–ª–∏ –≤ Vibe Coding: –ö—Ç–æ –∑–∞ —á—Ç–æ –æ—Ç–≤–µ—á–∞–µ—Ç

## –í–≤–µ–¥–µ–Ω–∏–µ

Vibe Coding ‚Äî —ç—Ç–æ –Ω–µ –ø—Ä–æ—Å—Ç–æ ¬´AI –ø–∏—à–µ—Ç –∫–æ–¥¬ª. –≠—Ç–æ –∫–æ–º–∞–Ω–¥–Ω–∞—è —Ä–∞–±–æ—Ç–∞, –≥–¥–µ —É –∫–∞–∂–¥–æ–≥–æ —É—á–∞—Å—Ç–Ω–∏–∫–∞ —Å–≤–æ—è –∑–æ–Ω–∞ –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç–∏. –ü–æ–Ω–∏–º–∞–Ω–∏–µ —ç—Ç–∏—Ö —Ä–æ–ª–µ–π –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏ –≤–∞–∂–Ω–æ –¥–ª—è —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ–π —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏.

---

## ü§ñ –†–æ–ª—å AI: –ò—Å–ø–æ–ª–Ω–∏—Ç–µ–ª—å –∏ –ø–æ–º–æ—â–Ω–∏–∫

AI –≤ Vibe Coding –≤—ã–ø–æ–ª–Ω—è–µ—Ç **–æ–ø–µ—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ –∑–∞–¥–∞—á–∏** ‚Äî —Ç–æ, —á—Ç–æ –º–æ–∂–Ω–æ —á—ë—Ç–∫–æ –æ–ø–∏—Å–∞—Ç—å –∏ –¥–µ–ª–µ–≥–∏—Ä–æ–≤–∞—Ç—å.

### –ß—Ç–æ AI –¥–µ–ª–∞–µ—Ç —Ö–æ—Ä–æ—à–æ:

**1. –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –∫–æ–¥–∞ –ø–æ –æ–ø–∏—Å–∞–Ω–∏—é**
–í—ã –æ–ø–∏—Å—ã–≤–∞–µ—Ç–µ, —á—Ç–æ –Ω—É–∂–Ω–æ ‚Äî AI –ø–∏—à–µ—Ç –∫–æ–¥. –ù–∞–ø—Ä–∏–º–µ—Ä:
\`\`\`
"–ù–∞–ø–∏—à–∏ —Ñ—É–Ω–∫—Ü–∏—é –≤–∞–ª–∏–¥–∞—Ü–∏–∏ email –Ω–∞ TypeScript
—Å –ø—Ä–æ–≤–µ—Ä–∫–æ–π —Ñ–æ—Ä–º–∞—Ç–∞ –∏ –¥–æ–º–µ–Ω–Ω–æ–π —á–∞—Å—Ç–∏"
\`\`\`

AI –≤—ã–¥–∞—Å—Ç –≥–æ—Ç–æ–≤—É—é —Ñ—É–Ω–∫—Ü–∏—é —Å —Ä–µ–≥—É–ª—è—Ä–Ω—ã–º –≤—ã—Ä–∞–∂–µ–Ω–∏–µ–º, —Ç–∏–ø–∞–º–∏ –∏ –æ–±—Ä–∞–±–æ—Ç–∫–æ–π –æ—à–∏–±–æ–∫.

**2. –†—É—Ç–∏–Ω–Ω—ã–π —Ä–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥**
- –ü–µ—Ä–µ–∏–º–µ–Ω–æ–≤–∞–Ω–∏–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –ø–æ –≤—Å–µ–º—É —Ñ–∞–π–ª—É
- –ö–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏—è callback –≤ async/await
- –†–∞–∑–±–∏–µ–Ω–∏–µ –±–æ–ª—å—à–æ–π —Ñ—É–Ω–∫—Ü–∏–∏ –Ω–∞ –º–∞–ª–µ–Ω—å–∫–∏–µ
- –î–æ–±–∞–≤–ª–µ–Ω–∏–µ —Ç–∏–ø–æ–≤ –≤ JavaScript –∫–æ–¥

**3. –ü—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–µ –ø–∞—Ç—Ç–µ—Ä–Ω–æ–≤ –∏ —Ä–µ—à–µ–Ω–∏–π**
AI –∑–Ω–∞–µ—Ç —Ç—ã—Å—è—á–∏ –ø–∞—Ç—Ç–µ—Ä–Ω–æ–≤ –∏–∑ –æ—Ç–∫—Ä—ã—Ç–æ–≥–æ –∫–æ–¥–∞. –°–ø—Ä–æ—Å–∏—Ç–µ:
\`\`\`
"–ö–∞–∫–æ–π –ø–∞—Ç—Ç–µ—Ä–Ω –ª—É—á—à–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è
—Å–æ—Å—Ç–æ—è–Ω–∏–µ–º —Ñ–æ—Ä–º—ã –≤ React?"
\`\`\`

–ü–æ–ª—É—á–∏—Ç–µ —Å—Ä–∞–≤–Ω–µ–Ω–∏–µ useState, useReducer, React Hook Form —Å –ø–ª—é—Å–∞–º–∏ –∏ –º–∏–Ω—É—Å–∞–º–∏.

**4. Boilerplate –∏ —à–∞–±–ª–æ–Ω—ã**
- –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ø—Ä–æ–µ–∫—Ç–∞ (package.json, tsconfig, eslint)
- CRUD –æ–ø–µ—Ä–∞—Ü–∏–∏ –¥–ª—è API
- –ö–æ–º–ø–æ–Ω–µ–Ω—Ç—ã UI –ø–æ –æ–ø–∏—Å–∞–Ω–∏—é
- –¢–µ—Å—Ç—ã –¥–ª—è —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–≥–æ –∫–æ–¥–∞

### –ß—Ç–æ AI –¥–µ–ª–∞–µ—Ç –ø–ª–æ—Ö–æ:

- ‚ùå –ù–µ –ø–æ–Ω–∏–º–∞–µ—Ç –±–∏–∑–Ω–µ—Å-–∫–æ–Ω—Ç–µ–∫—Å—Ç –≤–∞—à–µ–≥–æ –ø—Ä–æ–µ–∫—Ç–∞
- ‚ùå –ú–æ–∂–µ—Ç –ø—Ä–µ–¥–ª–æ–∂–∏—Ç—å —É—Å—Ç–∞—Ä–µ–≤—à–∏–µ –∏–ª–∏ –Ω–µ–±–µ–∑–æ–ø–∞—Å–Ω—ã–µ —Ä–µ—à–µ–Ω–∏—è
- ‚ùå –ù–µ –∑–Ω–∞–µ—Ç –æ –≤–∞—à–∏—Ö –≤–Ω—É—Ç—Ä–µ–Ω–Ω–∏—Ö –¥–æ–≥–æ–≤–æ—Ä—ë–Ω–Ω–æ—Å—Ç—è—Ö –≤ –∫–æ–º–∞–Ω–¥–µ
- ‚ùå –ù–µ –Ω–µ—Å—ë—Ç –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç–∏ –∑–∞ production –±–∞–≥–∏

---

## üë®‚Äçüíª –†–æ–ª—å —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–∞: –ê—Ä—Ö–∏—Ç–µ–∫—Ç–æ—Ä –∏ –∫–æ–Ω—Ç—Ä–æ–ª—ë—Ä

–†–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫ –≤ Vibe Coding ‚Äî —ç—Ç–æ **—Å—Ç—Ä–∞—Ç–µ–≥**, –∫–æ—Ç–æ—Ä—ã–π –Ω–∞–ø—Ä–∞–≤–ª—è–µ—Ç AI –∏ –ø—Ä–æ–≤–µ—Ä—è–µ—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç.

### –ö–ª—é—á–µ–≤—ã–µ –æ–±—è–∑–∞–Ω–Ω–æ—Å—Ç–∏:

**1. –§–æ—Ä–º—É–ª–∏—Ä–æ–≤–∫–∞ –∑–∞–¥–∞—á**
–ü–ª–æ—Ö–æ: "—Å–¥–µ–ª–∞–π —Ñ–æ—Ä–º—É"
–•–æ—Ä–æ—à–æ:
\`\`\`
"–°–æ–∑–¥–∞–π —Ñ–æ—Ä–º—É —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ –Ω–∞ React —Å –ø–æ–ª—è–º–∏:
email (–≤–∞–ª–∏–¥–∞—Ü–∏—è —Ñ–æ—Ä–º–∞—Ç–∞), –ø–∞—Ä–æ–ª—å (–º–∏–Ω. 8 —Å–∏–º–≤–æ–ª–æ–≤,
—Ü–∏—Ñ—Ä–∞, —Å–ø–µ—Ü—Å–∏–º–≤–æ–ª), –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ –ø–∞—Ä–æ–ª—è.
–ò—Å–ø–æ–ª—å–∑—É–π React Hook Form + Zod –¥–ª—è –≤–∞–ª–∏–¥–∞—Ü–∏–∏.
–°—Ç–∏–ª–∏–∑–∞—Ü–∏—è —á–µ—Ä–µ–∑ Tailwind CSS."
\`\`\`

**2. –ü—Ä–æ–≤–µ—Ä–∫–∞ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ –∫–æ–¥–∞**
AI –º–æ–∂–µ—Ç –ø—Ä–µ–¥–ª–æ–∂–∏—Ç—å:
- SQL –∑–∞–ø—Ä–æ—Å—ã –±–µ–∑ –ø–∞—Ä–∞–º–µ—Ç—Ä–∏–∑–∞—Ü–∏–∏ (SQL injection)
- –•—Ä–∞–Ω–µ–Ω–∏–µ –ø–∞—Ä–æ–ª–µ–π –≤ plain text
- CORS —Å wildcard (*)
- Eval() —Å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–º –≤–≤–æ–¥–æ–º

**–í–∞—à–∞ –∑–∞–¥–∞—á–∞** ‚Äî –≤–∏–¥–µ—Ç—å —ç—Ç–∏ –ø—Ä–æ–±–ª–µ–º—ã –∏ —Ç—Ä–µ–±–æ–≤–∞—Ç—å –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è.

**3. –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω—ã–µ —Ä–µ—à–µ–Ω–∏—è**
- –í—ã–±–æ—Ä —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–π –∏ –±–∏–±–ª–∏–æ—Ç–µ–∫
- –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø–∞–ø–æ–∫ –∏ –º–æ–¥—É–ª–µ–π
- –ü–∞—Ç—Ç–µ—Ä–Ω—ã –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—è –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤
- –†–µ—à–µ–Ω–∏—è –ø–æ –º–∞—Å—à—Ç–∞–±–∏—Ä—É–µ–º–æ—Å—Ç–∏

AI –º–æ–∂–µ—Ç –ø—Ä–µ–¥–ª–æ–∂–∏—Ç—å –≤–∞—Ä–∏–∞–Ω—Ç—ã, –Ω–æ **–≤—ã–±–æ—Ä –∑–∞ –≤–∞–º–∏**.

**4. –§–∏–Ω–∞–ª—å–Ω–∞—è –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç—å**
–ö–æ–¥ –≤ production = –≤–∞—à–∞ –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç—å. –ï—Å–ª–∏ AI –Ω–∞–ø–∏—Å–∞–ª –±–∞–≥, –∫–æ—Ç–æ—Ä—ã–π —Å–ª–æ–º–∞–ª —Å–∏—Å—Ç–µ–º—É ‚Äî –æ—Ç–≤–µ—á–∞–µ—Ç–µ –≤—ã, –∞ –Ω–µ ChatGPT.

---

## –ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏–π –ø—Ä–∏–º–µ—Ä

### –ó–∞–¥–∞—á–∞: –î–æ–±–∞–≤–∏—Ç—å –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—é –≤ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ

**–ß—Ç–æ –¥–µ–ª–∞–µ—Ç —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫:**
1. –†–µ—à–∞–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å JWT + httpOnly cookies (–∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞)
2. –í—ã–±–∏—Ä–∞–µ—Ç –±–∏–±–ª–∏–æ—Ç–µ–∫—É (jose –¥–ª—è JWT)
3. –û–ø—Ä–µ–¥–µ–ª—è–µ—Ç flow: login ‚Üí token ‚Üí refresh

**–ß—Ç–æ –¥–µ–ª–µ–≥–∏—Ä—É–µ—Ç AI:**
1. "–ù–∞–ø–∏—à–∏ middleware –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ JWT —Ç–æ–∫–µ–Ω–∞ –≤ Next.js"
2. "–°–æ–∑–¥–∞–π API route –¥–ª—è login —Å –≤–∞–ª–∏–¥–∞—Ü–∏–µ–π"
3. "–î–æ–±–∞–≤—å refresh token –ª–æ–≥–∏–∫—É"

**–ß—Ç–æ –ø—Ä–æ–≤–µ—Ä—è–µ—Ç —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫:**
- –¢–æ–∫–µ–Ω—ã –Ω–µ —Ö—Ä–∞–Ω—è—Ç—Å—è –≤ localStorage (XSS)
- –ü–∞—Ä–æ–ª–∏ —Ö–µ—à–∏—Ä—É—é—Ç—Å—è (bcrypt, –Ω–µ md5)
- Rate limiting –Ω–∞ login endpoint
- –ü—Ä–∞–≤–∏–ª—å–Ω—ã–µ HTTP —Å—Ç–∞—Ç—É—Å—ã (401, 403)

---

## –ó–∞–¥–∞–Ω–∏–µ

–¢–µ–ø–µ—Ä—å –ø—Ä–æ–≤–µ—Ä–∏–º, –∫–∞–∫ –≤—ã –ø–æ–Ω—è–ª–∏ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Ä–æ–ª–µ–π. –°–æ–µ–¥–∏–Ω–∏—Ç–µ –∫–∞–∂–¥—É—é –∑–∞–¥–∞—á—É —Å —Ç–µ–º, –∫—Ç–æ –¥–æ–ª–∂–µ–Ω –µ—ë –≤—ã–ø–æ–ª–Ω—è—Ç—å.`

    // Rich content for "–ü–æ—Ä—è–¥–æ–∫ —Ä–∞–±–æ—Ç—ã —Å AI"
    const workflowContent = `# –ü–æ—Ä—è–¥–æ–∫ —Ä–∞–±–æ—Ç—ã —Å AI: –ü–æ—à–∞–≥–æ–≤—ã–π –ø—Ä–æ—Ü–µ—Å—Å

## –ü–æ—á–µ–º—É –ø–æ—Ä—è–¥–æ–∫ –≤–∞–∂–µ–Ω

–ú–Ω–æ–≥–∏–µ —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–∏ —Ä–∞–±–æ—Ç–∞—é—Ç —Å AI —Ö–∞–æ—Ç–∏—á–Ω–æ: —Å–ø—Ä–æ—Å–∏–ª ‚Äî –ø–æ–ª—É—á–∏–ª –∫–æ–¥ ‚Äî –≤—Å—Ç–∞–≤–∏–ª ‚Äî –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç ‚Äî —Å–ø—Ä–æ—Å–∏–ª —Å–Ω–æ–≤–∞. –≠—Ç–æ –Ω–µ—ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ.

**–ü—Ä–∞–≤–∏–ª—å–Ω—ã–π –ø—Ä–æ—Ü–µ—Å—Å** —ç–∫–æ–Ω–æ–º–∏—Ç –≤—Ä–µ–º—è –∏ –¥–∞—ë—Ç –ø—Ä–µ–¥—Å–∫–∞–∑—É–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç.

---

## –®–∞–≥ 1: –°—Ñ–æ—Ä–º—É–ª–∏—Ä–æ–≤–∞—Ç—å —á—ë—Ç–∫—É—é –∑–∞–¥–∞—á—É

### –ß—Ç–æ —ç—Ç–æ –∑–Ω–∞—á–∏—Ç

–ü—Ä–µ–∂–¥–µ —á–µ–º –ø–∏—Å–∞—Ç—å –ø—Ä–æ–º–ø—Ç, –æ—Ç–≤–µ—Ç—å—Ç–µ —Å–µ–±–µ:
- –ß—Ç–æ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ –¥–æ–ª–∂–Ω–æ –ø–æ–ª—É—á–∏—Ç—å—Å—è?
- –ö–∞–∫–æ–π input –∏ output?
- –ö–∞–∫–∏–µ edge cases?

### –ü–ª–æ—Ö–æ–π –ø—Ä–∏–º–µ—Ä
\`\`\`
"–°–¥–µ–ª–∞–π –ø–æ–∏—Å–∫"
\`\`\`

### –•–æ—Ä–æ—à–∏–π –ø—Ä–∏–º–µ—Ä
\`\`\`
"–ù—É–∂–Ω–∞ —Ñ—É–Ω–∫—Ü–∏—è –ø–æ–∏—Å–∫–∞ —Ç–æ–≤–∞—Ä–æ–≤:
- Input: —Å—Ç—Ä–æ–∫–∞ –∑–∞–ø—Ä–æ—Å–∞, –º–∞—Å—Å–∏–≤ —Ç–æ–≤–∞—Ä–æ–≤
- Output: –æ—Ç—Ñ–∏–ª—å—Ç—Ä–æ–≤–∞–Ω–Ω—ã–π –º–∞—Å—Å–∏–≤
- –ò—Å–∫–∞—Ç—å –ø–æ –ø–æ–ª—è–º: name, description, tags
- Case-insensitive
- –ü–æ–¥–¥–µ—Ä–∂–∫–∞ —á–∞—Å—Ç–∏—á–Ω–æ–≥–æ —Å–æ–≤–ø–∞–¥–µ–Ω–∏—è"
\`\`\`

### –ü—Ä–∞–∫—Ç–∏–∫–∞

–ü–µ—Ä–µ–¥ –ø—Ä–æ–º–ø—Ç–æ–º –∑–∞–ø–∏—à–∏—Ç–µ –≤ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏:
\`\`\`javascript
// –ó–ê–î–ê–ß–ê: –í–∞–ª–∏–¥–∞—Ü–∏—è —Ñ–æ—Ä–º—ã —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏
// INPUT: –æ–±—ä–µ–∫—Ç { email, password, confirmPassword }
// OUTPUT: { valid: boolean, errors: string[] }
// –ü–†–ê–í–ò–õ–ê:
// - email: —Ñ–æ—Ä–º–∞—Ç xxx@xxx.xx
// - password: –º–∏–Ω 8 —Å–∏–º–≤–æ–ª–æ–≤, 1 —Ü–∏—Ñ—Ä–∞, 1 —Å–ø–µ—Ü—Å–∏–º–≤–æ–ª
// - confirmPassword === password
\`\`\`

–¢–µ–ø–µ—Ä—å –ø—Ä–æ–º–ø—Ç –Ω–∞–ø–∏—à–µ—Ç—Å—è —Å–∞–º.

---

## –®–∞–≥ 2: –î–æ–±–∞–≤–∏—Ç—å –∫–æ–Ω—Ç–µ–∫—Å—Ç –∏ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è

### –ß—Ç–æ —Ç–∞–∫–æ–µ –∫–æ–Ω—Ç–µ–∫—Å—Ç

AI –Ω–µ –∑–Ω–∞–µ—Ç –≤–∞—à –ø—Ä–æ–µ–∫—Ç. –ï–º—É –Ω—É–∂–Ω–æ –æ–±—ä—è—Å–Ω–∏—Ç—å:
- –ö–∞–∫–∏–µ —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–∏ –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è
- –ö–∞–∫–æ–π —Å—Ç–∏–ª—å –∫–æ–¥–∞ –ø—Ä–∏–Ω—è—Ç
- –ö–∞–∫–∏–µ –µ—Å—Ç—å –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è

### –ü—Ä–∏–º–µ—Ä –±–µ–∑ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞
\`\`\`
"–ù–∞–ø–∏—à–∏ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç –∫–∞—Ä—Ç–æ—á–∫–∏ —Ç–æ–≤–∞—Ä–∞"
\`\`\`

AI –º–æ–∂–µ—Ç –≤—ã–¥–∞—Ç—å:
- –ö–ª–∞—Å—Å –Ω–∞ React (–∞ —É –≤–∞—Å —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã)
- Styled-components (–∞ —É –≤–∞—Å Tailwind)
- JavaScript (–∞ —É –≤–∞—Å TypeScript)

### –ü—Ä–∏–º–µ—Ä —Å –∫–æ–Ω—Ç–µ–∫—Å—Ç–æ–º
\`\`\`
"–ù–∞–ø–∏—à–∏ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç –∫–∞—Ä—Ç–æ—á–∫–∏ —Ç–æ–≤–∞—Ä–∞.

–ö–æ–Ω—Ç–µ–∫—Å—Ç:
- Next.js 14 —Å App Router
- TypeScript strict mode
- Tailwind CSS –¥–ª—è —Å—Ç–∏–ª–µ–π
- –ò—Å–ø–æ–ª—å–∑—É–µ–º –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å Product: { id, name, price, image }

–¢—Ä–µ–±–æ–≤–∞–Ω–∏—è:
- –§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–π –∫–æ–º–ø–æ–Ω–µ–Ω—Ç
- Props —á–µ—Ä–µ–∑ interface
- –ê–¥–∞–ø—Ç–∏–≤–Ω—ã–π –¥–∏–∑–∞–π–Ω (mobile-first)
- –°—Å—ã–ª–∫–∞ –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü—É —Ç–æ–≤–∞—Ä–∞ /products/[id]"
\`\`\`

### –®–∞–±–ª–æ–Ω –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞

–°–æ–∑–¥–∞–π—Ç–µ —Ñ–∞–π–ª CONTEXT.md –≤ –ø—Ä–æ–µ–∫—Ç–µ:
\`\`\`markdown
# –ö–æ–Ω—Ç–µ–∫—Å—Ç –ø—Ä–æ–µ–∫—Ç–∞ –¥–ª—è AI

## –°—Ç–µ–∫
- Next.js 14 (App Router)
- TypeScript 5
- Tailwind CSS
- Prisma ORM
- PostgreSQL

## –ö–æ–Ω–≤–µ–Ω—Ü–∏–∏
- –§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã
- Named exports
- camelCase –¥–ª—è –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö
- PascalCase –¥–ª—è –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤

## –°—Ç—Ä—É–∫—Ç—É—Ä–∞
src/
  app/        # Pages
  components/ # UI –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã
  lib/        # –£—Ç–∏–ª–∏—Ç—ã
  types/      # TypeScript —Ç–∏–ø—ã
\`\`\`

–ö–æ–ø–∏—Ä—É–π—Ç–µ –≤ –Ω–∞—á–∞–ª–æ –ø—Ä–æ–º–ø—Ç–∞ –ø—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏.

---

## –®–∞–≥ 3: –ü–æ–ª—É—á–∏—Ç—å –∫–æ–¥ –æ—Ç AI

### –ö–∞–∫ –∑–∞–ø—Ä–∞—à–∏–≤–∞—Ç—å

**–û–¥–∏–Ω –∑–∞–ø—Ä–æ—Å ‚Äî –æ–¥–Ω–∞ –∑–∞–¥–∞—á–∞.** –ù–µ –ø—Ä–æ—Å–∏—Ç–µ:
\`\`\`
"–°–¥–µ–ª–∞–π –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—é, —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—é,
–≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –ø–∞—Ä–æ–ª—è –∏ –ø—Ä–æ—Ñ–∏–ª—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è"
\`\`\`

–†–∞–∑–±–µ–π—Ç–µ:
1. "–°–¥–µ–ª–∞–π —Ñ–æ—Ä–º—É —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ —Å –≤–∞–ª–∏–¥–∞—Ü–∏–µ–π"
2. "–î–æ–±–∞–≤—å API route –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è"
3. "–°–¥–µ–ª–∞–π —Ñ–æ—Ä–º—É –ª–æ–≥–∏–Ω–∞"
4. –ò —Ç–∞–∫ –¥–∞–ª–µ–µ...

### –ò—Ç–µ—Ä–∞—Ç–∏–≤–Ω—ã–π –ø–æ–¥—Ö–æ–¥

–ü–æ–ª—É—á–∏–ª–∏ –∫–æ–¥ ‚Üí –ø–æ–ø—Ä–æ—Å–∏–ª–∏ —É–ª—É—á—à–∏—Ç—å ‚Üí –ø–æ–ª—É—á–∏–ª–∏ –ª—É—á—à–µ
\`\`\`
"–î–æ–±–∞–≤—å –æ–±—Ä–∞–±–æ—Ç–∫—É –æ—à–∏–±–æ–∫ —Å–µ—Ç–∏"
"–í—ã–Ω–µ—Å–∏ –≤–∞–ª–∏–¥–∞—Ü–∏—é –≤ –æ—Ç–¥–µ–ª—å–Ω—É—é —Ñ—É–Ω–∫—Ü–∏—é"
"–î–æ–±–∞–≤—å TypeScript —Ç–∏–ø—ã –¥–ª—è response"
\`\`\`

---

## –®–∞–≥ 4: –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∫–æ–¥ –Ω–∞ –æ—à–∏–±–∫–∏ –∏ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

### –ß–µ–∫-–ª–∏—Å—Ç –ø—Ä–æ–≤–µ—Ä–∫–∏

**–§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å:**
- [ ] –ö–æ–¥ –¥–µ–ª–∞–µ—Ç —Ç–æ, —á—Ç–æ –Ω—É–∂–Ω–æ?
- [ ] –û–±—Ä–∞–±–æ—Ç–∞–Ω—ã edge cases?
- [ ] –ü–æ–Ω—è—Ç–Ω—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è –æ–± –æ—à–∏–±–∫–∞—Ö?

**–ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å:**
- [ ] –ù–µ—Ç SQL injection (–ø–∞—Ä–∞–º–µ—Ç—Ä–∏–∑–æ–≤–∞–Ω–Ω—ã–µ –∑–∞–ø—Ä–æ—Å—ã)?
- [ ] –ù–µ—Ç XSS (—ç–∫—Ä–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –≤—ã–≤–æ–¥–∞)?
- [ ] –°–µ–∫—Ä–µ—Ç—ã –Ω–µ –≤ –∫–æ–¥–µ?
- [ ] –í–∞–ª–∏–¥–∞—Ü–∏—è –≤—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö?

**–ö–∞—á–µ—Å—Ç–≤–æ:**
- [ ] –ö–æ–¥ —á–∏—Ç–∞–µ–º—ã–π?
- [ ] –ù–µ—Ç –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏—è?
- [ ] –ü—Ä–∞–≤–∏–ª—å–Ω—ã–µ —Ç–∏–ø—ã?
- [ ] –°–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç —Å—Ç–∏–ª—é –ø—Ä–æ–µ–∫—Ç–∞?

### –ö—Ä–∞—Å–Ω—ã–µ —Ñ–ª–∞–≥–∏

–ï—Å–ª–∏ –≤–∏–¥–∏—Ç–µ –≤ –∫–æ–¥–µ –æ—Ç AI:
\`\`\`javascript
// üö® –ü–ª–æ—Ö–æ
eval(userInput)
document.innerHTML = userData
db.query("SELECT * FROM users WHERE id = " + id)
localStorage.setItem('token', jwt)
\`\`\`

**–ù–µ–º–µ–¥–ª–µ–Ω–Ω–æ –ø—Ä–æ—Å–∏—Ç–µ –ø–µ—Ä–µ–ø–∏—Å–∞—Ç—å!**

---

## –®–∞–≥ 5: –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å —Ä–∞–±–æ—Ç—É –∫–æ–¥–∞

### –£—Ä–æ–≤–Ω–∏ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è

**1. –†—É—á–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ**
- –ó–∞–ø—É—Å—Ç–∏—Ç–µ –∫–æ–¥
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ happy path
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ edge cases
- –ü–æ–ø—Ä–æ–±—É–π—Ç–µ —Å–ª–æ–º–∞—Ç—å

**2. –ê–≤—Ç–æ—Ç–µ—Å—Ç—ã**
–ü–æ–ø—Ä–æ—Å–∏—Ç–µ AI –Ω–∞–ø–∏—Å–∞—Ç—å —Ç–µ—Å—Ç—ã:
\`\`\`
"–ù–∞–ø–∏—à–∏ unit —Ç–µ—Å—Ç—ã –¥–ª—è —ç—Ç–æ–π —Ñ—É–Ω–∫—Ü–∏–∏.
–ü–æ–∫—Ä–æ–π: happy path, –ø—É—Å—Ç–æ–π input,
–Ω–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ, –≥—Ä–∞–Ω–∏—á–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è."
\`\`\`

**3. –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ**
- –†–∞–±–æ—Ç–∞–µ—Ç –ª–∏ —Å –æ—Å—Ç–∞–ª—å–Ω—ã–º –∫–æ–¥–æ–º?
- –ù–µ—Ç –ª–∏ –∫–æ–Ω—Ñ–ª–∏–∫—Ç–æ–≤?
- –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –≤ –Ω–æ—Ä–º–µ?

---

## –®–∞–≥ 6: –ò–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞—Ç—å –≤ –ø—Ä–æ–µ–∫—Ç

### –î–æ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏

- –ö–æ–¥ –ø—Ä–æ—Ö–æ–¥–∏—Ç –ª–∏–Ω—Ç–µ—Ä?
- –¢–µ—Å—Ç—ã –ø—Ä–æ—Ö–æ–¥—è—Ç?
- –ù—É–∂–µ–Ω –ª–∏ code review?

### –ü—Ä–æ—Ü–µ—Å—Å –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏

1. –°–æ–∑–¥–∞–π—Ç–µ feature branch
2. –î–æ–±–∞–≤—å—Ç–µ –∫–æ–¥
3. –ó–∞–ø—É—Å—Ç–∏—Ç–µ —Ç–µ—Å—Ç—ã
4. –°–æ–∑–¥–∞–π—Ç–µ PR —Å –æ–ø–∏—Å–∞–Ω–∏–µ–º
5. Code review (–µ—Å–ª–∏ –∫–æ–º–∞–Ω–¥–∞)
6. Merge –≤ main

### –ü–æ—Å–ª–µ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏

- –°–ª–µ–¥–∏—Ç–µ –∑–∞ –æ—à–∏–±–∫–∞–º–∏ –≤ –ª–æ–≥–∞—Ö
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –º–µ—Ç—Ä–∏–∫–∏ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏
- –ë—É–¥—å—Ç–µ –≥–æ—Ç–æ–≤—ã –æ—Ç–∫–∞—Ç–∏—Ç—å

---

## –ó–∞–¥–∞–Ω–∏–µ

–†–∞—Å—Å—Ç–∞–≤—å—Ç–µ —à–∞–≥–∏ —Ä–∞–±–æ—Ç—ã —Å AI –≤ –ø—Ä–∞–≤–∏–ª—å–Ω–æ–º –ø–æ—Ä—è–¥–∫–µ. –ü–æ–º–Ω–∏—Ç–µ: –ø—Ä–æ–ø—É—Å–∫ —à–∞–≥–∞ –∏–ª–∏ –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–π –ø–æ—Ä—è–¥–æ–∫ = –ø—Ä–æ–±–ª–µ–º—ã.`

    // Rich content for "–ê–Ω–∞–ª–∏–∑ –ø—Ä–æ–º–ø—Ç–æ–≤"
    const promptAnalysisContent = `# –ê–Ω–∞–ª–∏–∑ –ø—Ä–æ–º–ø—Ç–æ–≤: –ö–∞–∫ –ø–∏—Å–∞—Ç—å —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω—ã–µ –∑–∞–ø—Ä–æ—Å—ã –∫ AI

## –ü–æ—á–µ–º—É —ç—Ç–æ –≤–∞–∂–Ω–æ

**80% –∫–∞—á–µ—Å—Ç–≤–∞ –∫–æ–¥–∞ –æ—Ç AI –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç—Å—è –∫–∞—á–µ—Å—Ç–≤–æ–º –ø—Ä–æ–º–ø—Ç–∞.**

–¢–æ—Ç –∂–µ ChatGPT/Claude –¥–∞—ë—Ç —Å–æ–≤–µ—Ä—à–µ–Ω–Ω–æ —Ä–∞–∑–Ω—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç —Ç–æ–≥–æ, –∫–∞–∫ –≤—ã —Å–ø—Ä–æ—Å–∏—Ç–µ. –ù–∞—É—á–∏—Ç–µ—Å—å –≤–∏–¥–µ—Ç—å –ø—Ä–æ–±–ª–µ–º—ã –≤ –ø—Ä–æ–º–ø—Ç–∞—Ö ‚Äî –Ω–∞—É—á–∏—Ç–µ—Å—å –ø–æ–ª—É—á–∞—Ç—å —Ö–æ—Ä–æ—à–∏–π –∫–æ–¥.

---

## –ê–Ω–∞—Ç–æ–º–∏—è —Ö–æ—Ä–æ—à–µ–≥–æ –ø—Ä–æ–º–ø—Ç–∞

### 5 –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã—Ö —ç–ª–µ–º–µ–Ω—Ç–æ–≤:

**1. –ö–æ–Ω—Ç–µ–∫—Å—Ç –ø—Ä–æ–µ–∫—Ç–∞**
\`\`\`
"–í –ø—Ä–æ–µ–∫—Ç–µ –Ω–∞ Next.js 14 —Å TypeScript –∏ Tailwind..."
\`\`\`

**2. –ß—ë—Ç–∫–∞—è –∑–∞–¥–∞—á–∞**
\`\`\`
"...–Ω—É–∂–Ω–æ —Å–æ–∑–¥–∞—Ç—å –∫–æ–º–ø–æ–Ω–µ–Ω—Ç –º–æ–¥–∞–ª—å–Ω–æ–≥–æ –æ–∫–Ω–∞..."
\`\`\`

**3. –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è –∫ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—É**
\`\`\`
"...—Å –∞–Ω–∏–º–∞—Ü–∏–µ–π –ø–æ—è–≤–ª–µ–Ω–∏—è, –∫–Ω–æ–ø–∫–æ–π –∑–∞–∫—Ä—ã—Ç–∏—è,
–∑–∞—Ç–µ–º–Ω–µ–Ω–∏–µ–º —Ñ–æ–Ω–∞, –∑–∞–∫—Ä—ã—Ç–∏–µ–º –ø–æ Escape..."
\`\`\`

**4. –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è**
\`\`\`
"...–±–µ–∑ –≤–Ω–µ—à–Ω–∏—Ö –±–∏–±–ª–∏–æ—Ç–µ–∫, —Ç–æ–ª—å–∫–æ CSS transitions..."
\`\`\`

**5. –§–æ—Ä–º–∞—Ç –æ—Ç–≤–µ—Ç–∞**
\`\`\`
"...–¥–∞–π –∫–æ–¥ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞ –∏ –ø—Ä–∏–º–µ—Ä –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è"
\`\`\`

### –ü–æ–ª–Ω—ã–π –ø—Ä–æ–º–ø—Ç:
\`\`\`
–í –ø—Ä–æ–µ–∫—Ç–µ –Ω–∞ Next.js 14 —Å TypeScript –∏ Tailwind
–Ω—É–∂–Ω–æ —Å–æ–∑–¥–∞—Ç—å –∫–æ–º–ø–æ–Ω–µ–Ω—Ç –º–æ–¥–∞–ª—å–Ω–æ–≥–æ –æ–∫–Ω–∞ —Å –∞–Ω–∏–º–∞—Ü–∏–µ–π
–ø–æ—è–≤–ª–µ–Ω–∏—è, –∫–Ω–æ–ø–∫–æ–π –∑–∞–∫—Ä—ã—Ç–∏—è, –∑–∞—Ç–µ–º–Ω–µ–Ω–∏–µ–º —Ñ–æ–Ω–∞,
–∑–∞–∫—Ä—ã—Ç–∏–µ–º –ø–æ Escape –∏ –∫–ª–∏–∫—É –≤–Ω–µ –º–æ–¥–∞–ª–∫–∏.

–ë–µ–∑ –≤–Ω–µ—à–Ω–∏—Ö –±–∏–±–ª–∏–æ—Ç–µ–∫, —Ç–æ–ª—å–∫–æ CSS transitions.
–î–∞–π –∫–æ–¥ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞ –∏ –ø—Ä–∏–º–µ—Ä –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è.
\`\`\`

---

## –¢–∏–ø–∏—á–Ω—ã–µ –æ—à–∏–±–∫–∏ –≤ –ø—Ä–æ–º–ø—Ç–∞—Ö

### –û—à–∏–±–∫–∞ 1: –†–∞–∑–º—ã—Ç—ã–µ –∞–Ω–∞–ª–æ–≥–∏–∏

‚ùå **–ü–ª–æ—Ö–æ:**
\`\`\`
"–°–¥–µ–ª–∞–π –∫–∞–∫ –≤ Notion"
\`\`\`

–ß—Ç–æ –∏–º–µ–Ω–Ω–æ –∫–∞–∫ –≤ Notion? –†–µ–¥–∞–∫—Ç–æ—Ä? –ë–æ–∫–æ–≤–∞—è –ø–∞–Ω–µ–ª—å? –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö? –°—Ç–∏–ª—å –∫–Ω–æ–ø–æ–∫?

‚úÖ **–•–æ—Ä–æ—à–æ:**
\`\`\`
"–°–¥–µ–ª–∞–π drag-and-drop —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫—É –±–ª–æ–∫–æ–≤
–∫–∞–∫ –≤ Notion ‚Äî –ø–µ—Ä–µ—Ç–∞—Å–∫–∏–≤–∞–Ω–∏–µ –∑–∞ –∏–∫–æ–Ω–∫—É
—Å–ª–µ–≤–∞, –≤–∏–∑—É–∞–ª—å–Ω—ã–π –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä –ø–æ–∑–∏—Ü–∏–∏,
–ø–ª–∞–≤–Ω–∞—è –∞–Ω–∏–º–∞—Ü–∏—è"
\`\`\`

### –û—à–∏–±–∫–∞ 2: –°—É–±—ä–µ–∫—Ç–∏–≤–Ω—ã–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è

‚ùå **–ü–ª–æ—Ö–æ:**
\`\`\`
"–°–¥–µ–ª–∞–π –∫—Ä–∞—Å–∏–≤—É—é —Ñ–æ—Ä–º—É"
"–ù—É–∂–µ–Ω —Å–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–π –¥–∏–∑–∞–π–Ω"
"–°–¥–µ–ª–∞–π –∫–∞–∫ –Ω–∞–¥–æ"
\`\`\`

‚úÖ **–•–æ—Ä–æ—à–æ:**
\`\`\`
"–§–æ—Ä–º–∞ –≤ —Å—Ç–∏–ª–µ –º–∏–Ω–∏–º–∞–ª–∏–∑–º: –±–µ–ª—ã–π —Ñ–æ–Ω,
—Ç–æ–Ω–∫–∏–µ —Å–µ—Ä—ã–µ –≥—Ä–∞–Ω–∏—Ü—ã –∏–Ω–ø—É—Ç–æ–≤ (1px #e5e7eb),
focus state —Å —Å–∏–Ω–µ–π –≥—Ä–∞–Ω–∏—Ü–µ–π (#3b82f6),
—Å–∫—Ä—É–≥–ª–µ–Ω–∏–µ 8px, –æ—Ç—Å—Ç—É–ø—ã –º–µ–∂–¥—É –ø–æ–ª—è–º–∏ 16px"
\`\`\`

### –û—à–∏–±–∫–∞ 3: –ù–µ—Ç –ø–ª–∞—Ç—Ñ–æ—Ä–º—ã/—Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–π

‚ùå **–ü–ª–æ—Ö–æ:**
\`\`\`
"–ù–∞–ø–∏—à–∏ —Ñ—É–Ω–∫—Ü–∏—é –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏"
\`\`\`

–ù–∞ —á—ë–º? Node.js? Python? PHP? Vanilla JS?
–° –∫–∞–∫–æ–π –±–∞–∑–æ–π? JWT –∏–ª–∏ —Å–µ—Å—Å–∏–∏? OAuth?

‚úÖ **–•–æ—Ä–æ—à–æ:**
\`\`\`
"–ù–∞–ø–∏—à–∏ API endpoint –¥–ª—è –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ –Ω–∞ Next.js:
- POST /api/auth/login
- Body: { email, password }
- –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –≤ PostgreSQL —á–µ—Ä–µ–∑ Prisma
- –û—Ç–≤–µ—Ç: JWT —Ç–æ–∫–µ–Ω (jose –±–∏–±–ª–∏–æ—Ç–µ–∫–∞)
- –£—Å—Ç–∞–Ω–æ–≤–∫–∞ httpOnly cookie —Å —Ç–æ–∫–µ–Ω–æ–º"
\`\`\`

### –û—à–∏–±–∫–∞ 4: –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ —Ä–æ–ª–µ–π/–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π

‚ùå **–ü–ª–æ—Ö–æ:**
\`\`\`
"–°–¥–µ–ª–∞–π –¥–∞—à–±–æ—Ä–¥"
\`\`\`

‚úÖ **–•–æ—Ä–æ—à–æ:**
\`\`\`
"–°–¥–µ–ª–∞–π –¥–∞—à–±–æ—Ä–¥ –¥–ª—è –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç-–º–∞–≥–∞–∑–∏–Ω–∞:
- –í–∏–¥–∂–µ—Ç: –∑–∞–∫–∞–∑—ã –∑–∞ —Å–µ–≥–æ–¥–Ω—è (–∫–æ–ª–∏—á–µ—Å—Ç–≤–æ, —Å—É–º–º–∞)
- –í–∏–¥–∂–µ—Ç: –Ω–æ–≤—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –∑–∞ –Ω–µ–¥–µ–ª—é (–≥—Ä–∞—Ñ–∏–∫)
- –í–∏–¥–∂–µ—Ç: —Ç–æ–ø-5 —Ç–æ–≤–∞—Ä–æ–≤ –ø–æ –ø—Ä–æ–¥–∞–∂–∞–º
- –í–∏–¥–∂–µ—Ç: –∑–∞–∫–∞–∑—ã —Ç—Ä–µ–±—É—é—â–∏–µ –æ–±—Ä–∞–±–æ—Ç–∫–∏ (—Å—Ç–∞—Ç—É—Å pending)"
\`\`\`

### –û—à–∏–±–∫–∞ 5: "–õ—É—á—à–∏–µ –ø—Ä–∞–∫—Ç–∏–∫–∏" –±–µ–∑ –∫–æ–Ω–∫—Ä–µ—Ç–∏–∫–∏

‚ùå **–ü–ª–æ—Ö–æ:**
\`\`\`
"–ò—Å–ø–æ–ª—å–∑—É–π –ª—É—á—à–∏–µ –ø—Ä–∞–∫—Ç–∏–∫–∏"
\`\`\`

‚úÖ **–•–æ—Ä–æ—à–æ:**
\`\`\`
"–¢—Ä–µ–±–æ–≤–∞–Ω–∏—è –∫ –∫–∞—á–µ—Å—Ç–≤—É –∫–æ–¥–∞:
- –í—Å–µ —Ñ—É–Ω–∫—Ü–∏–∏ —Å TypeScript —Ç–∏–ø–∞–º–∏
- –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫ —á–µ—Ä–µ–∑ try/catch
- –í–∞–ª–∏–¥–∞—Ü–∏—è –≤—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö —á–µ—Ä–µ–∑ Zod
- –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏ JSDoc –¥–ª—è –ø—É–±–ª–∏—á–Ω—ã—Ö —Ñ—É–Ω–∫—Ü–∏–π
- –ö–æ–Ω—Å—Ç–∞–Ω—Ç—ã –≤–º–µ—Å—Ç–æ magic numbers"
\`\`\`

---

## –®–∞–±–ª–æ–Ω—ã —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω—ã—Ö –ø—Ä–æ–º–ø—Ç–æ–≤

### –î–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞:
\`\`\`
[–°—Ç–µ–∫: Next.js/React/Vue + TypeScript + CSS —Ñ—Ä–µ–π–º–≤–æ—Ä–∫]

–°–æ–∑–¥–∞–π –∫–æ–º–ø–æ–Ω–µ–Ω—Ç [–ù–∞–∑–≤–∞–Ω–∏–µ]:
- Props: [–ø–µ—Ä–µ—á–∏—Å–ª–∏—Ç—å —Å —Ç–∏–ø–∞–º–∏]
- –§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å: [—á—Ç–æ –¥–µ–ª–∞–µ—Ç]
- –°—Ç–∏–ª–∏: [—Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è –∫ –≤–Ω–µ—à–Ω–µ–º—É –≤–∏–¥—É]
- –°–æ—Å—Ç–æ—è–Ω–∏—è: [hover, active, disabled, loading]
- –î–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å: [a11y —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è –µ—Å–ª–∏ –µ—Å—Ç—å]

–î–∞–π –∫–æ–¥ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞ –∏ –ø—Ä–∏–º–µ—Ä –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è.
\`\`\`

### –î–ª—è API endpoint:
\`\`\`
[–°—Ç–µ–∫: —Ñ—Ä–µ–π–º–≤–æ—Ä–∫ + –±–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö + ORM]

–°–æ–∑–¥–∞–π API endpoint [–º–µ—Ç–æ–¥] [–ø—É—Ç—å]:
- Body/Query: [–ø–∞—Ä–∞–º–µ—Ç—Ä—ã —Å —Ç–∏–ø–∞–º–∏]
- –í–∞–ª–∏–¥–∞—Ü–∏—è: [–ø—Ä–∞–≤–∏–ª–∞]
- –õ–æ–≥–∏–∫–∞: [—á—Ç–æ –¥–µ–ª–∞–µ—Ç]
- Response: [—Ñ–æ—Ä–º–∞—Ç –æ—Ç–≤–µ—Ç–∞]
- –û—à–∏–±–∫–∏: [–∫–∞–∫–∏–µ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—Ç—å]
\`\`\`

### –î–ª—è —Ñ—É–Ω–∫—Ü–∏–∏/—É—Ç–∏–ª–∏—Ç—ã:
\`\`\`
–ù–∞–ø–∏—à–∏ —Ñ—É–Ω–∫—Ü–∏—é [–Ω–∞–∑–≤–∞–Ω–∏–µ]:
- Input: [–ø–∞—Ä–∞–º–µ—Ç—Ä—ã —Å —Ç–∏–ø–∞–º–∏]
- Output: [—á—Ç–æ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç]
- –õ–æ–≥–∏–∫–∞: [–∞–ª–≥–æ—Ä–∏—Ç–º/—á—Ç–æ –¥–µ–ª–∞–µ—Ç]
- Edge cases: [–≥—Ä–∞–Ω–∏—á–Ω—ã–µ —Å–ª—É—á–∞–∏]
- –ü—Ä–∏–º–µ—Ä –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è: [–ø–æ–∫–∞–∑–∞—Ç—å]
\`\`\`

---

## –ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–æ–µ –∑–∞–¥–∞–Ω–∏–µ

–ü—Ä–æ–∞–Ω–∞–ª–∏–∑–∏—Ä—É–π—Ç–µ –ø—Ä–æ–º–ø—Ç –æ—Ç –∑–∞–∫–∞–∑—á–∏–∫–∞ –∏ –Ω–∞–π–¥–∏—Ç–µ –≤—Å–µ –ø—Ä–æ–±–ª–µ–º—ã.

–ü–æ–º–Ω–∏—Ç–µ: –∫–∞–∂–¥–∞—è "—Ä–∞–∑–º—ã—Ç–æ—Å—Ç—å" –≤ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è—Ö = AI —Å–∞–º —Ä–µ—à–∏—Ç –∫–∞–∫ –¥–µ–ª–∞—Ç—å, –∏ —Å–∫–æ—Ä–µ–µ –≤—Å–µ–≥–æ –Ω–µ —Ç–∞–∫, –∫–∞–∫ –≤—ã —Ö–æ—Ç–µ–ª–∏.`

    // Update module contents
    const rolesModule = await prisma.module.findFirst({
      where: { title: "–†–æ–ª–∏ –≤ Vibe Coding" },
    })
    if (rolesModule) {
      await prisma.module.update({
        where: { id: rolesModule.id },
        data: { content: rolesContent },
      })
    }

    const workflowModule = await prisma.module.findFirst({
      where: { title: "–ü–æ—Ä—è–¥–æ–∫ —Ä–∞–±–æ—Ç—ã —Å AI" },
    })
    if (workflowModule) {
      await prisma.module.update({
        where: { id: workflowModule.id },
        data: { content: workflowContent },
      })
    }

    const analysisModule = await prisma.module.findFirst({
      where: { title: "–ê–Ω–∞–ª–∏–∑ –ø—Ä–æ–º–ø—Ç–æ–≤" },
    })
    if (analysisModule) {
      await prisma.module.update({
        where: { id: analysisModule.id },
        data: { content: promptAnalysisContent },
      })
    }

    return NextResponse.json({
      success: true,
      message: "–ö–æ–Ω—Ç–µ–Ω—Ç –º–æ–¥—É–ª–µ–π –æ–±–Ω–æ–≤–ª—ë–Ω",
      updated: {
        roles: !!rolesModule,
        workflow: !!workflowModule,
        analysis: !!analysisModule,
      },
    })
  } catch (error) {
    console.error("Content update error:", error)
    return NextResponse.json({ error: "–û—à–∏–±–∫–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –∫–æ–Ω—Ç–µ–Ω—Ç–∞" }, { status: 500 })
  }
}
